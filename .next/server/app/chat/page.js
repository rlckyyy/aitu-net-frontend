(()=>{var t={};t.id=457,t.ids=[457],t.modules={846:t=>{"use strict";t.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:t=>{"use strict";t.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:t=>{"use strict";t.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:t=>{"use strict";t.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},2412:t=>{"use strict";t.exports=require("assert")},9428:t=>{"use strict";t.exports=require("buffer")},5511:t=>{"use strict";t.exports=require("crypto")},4735:t=>{"use strict";t.exports=require("events")},9021:t=>{"use strict";t.exports=require("fs")},1630:t=>{"use strict";t.exports=require("http")},5591:t=>{"use strict";t.exports=require("https")},1645:t=>{"use strict";t.exports=require("net")},1820:t=>{"use strict";t.exports=require("os")},3873:t=>{"use strict";t.exports=require("path")},7910:t=>{"use strict";t.exports=require("stream")},4631:t=>{"use strict";t.exports=require("tls")},3997:t=>{"use strict";t.exports=require("tty")},9551:t=>{"use strict";t.exports=require("url")},8354:t=>{"use strict";t.exports=require("util")},4075:t=>{"use strict";t.exports=require("zlib")},7485:(t,e,s)=>{"use strict";s.r(e),s.d(e,{GlobalError:()=>o.a,__next_app__:()=>l,pages:()=>u,routeModule:()=>p,tree:()=>c});var r=s(260),i=s(8203),n=s(5155),o=s.n(n),a=s(7292),h={};for(let t in a)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(t)&&(h[t]=()=>a[t]);s.d(e,h);let c=["",{children:["chat",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5274)),"/Users/relucky/Desktop/programming/react/aitu-net-frontend/src/app/chat/page.tsx"]}]},{metadata:{icon:[async t=>(await Promise.resolve().then(s.bind(s,440))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,1354)),"/Users/relucky/Desktop/programming/react/aitu-net-frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,1485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async t=>(await Promise.resolve().then(s.bind(s,440))).default(t)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/Users/relucky/Desktop/programming/react/aitu-net-frontend/src/app/chat/page.tsx"],l={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/chat/page",pathname:"/chat",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},234:(t,e,s)=>{Promise.resolve().then(s.bind(s,5274))},9986:(t,e,s)=>{Promise.resolve().then(s.bind(s,1079))},7219:(t,e,s)=>{var r=s(9551).parse,i=s(4735),n=s(5591),o=s(1630),a=s(8354),h=["pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","secureProtocol","servername","checkServerIdentity"],c=[239,187,191],u=/^(cookie|authorization)$/i;function l(t,e){var s,i=l.CONNECTING,a=e&&e.headers,f=!1;Object.defineProperty(this,"readyState",{get:function(){return i}}),Object.defineProperty(this,"url",{get:function(){return t}});var m=this;function _(e){i!==l.CLOSED&&(i=l.CONNECTING,x("error",new p("error",{message:e})),E&&(t=E,E=null,f=!1),setTimeout(function(){i!==l.CONNECTING||m.connectionInProgress||(m.connectionInProgress=!0,S())},m.reconnectInterval))}m.reconnectInterval=1e3,m.connectionInProgress=!1;var g="";a&&a["Last-Event-ID"]&&(g=a["Last-Event-ID"],delete a["Last-Event-ID"]);var v=!1,y="",b="",E=null;function S(){var w=r(t),O="https:"===w.protocol;if(w.headers={"Cache-Control":"no-cache",Accept:"text/event-stream"},g&&(w.headers["Last-Event-ID"]=g),a){var C=f?function(t){var e={};for(var s in t)u.test(s)||(e[s]=t[s]);return e}(a):a;for(var T in C){var N=C[T];N&&(w.headers[T]=N)}}if(w.rejectUnauthorized=!(e&&!e.rejectUnauthorized),e&&void 0!==e.createConnection&&(w.createConnection=e.createConnection),e&&e.proxy){var k=r(e.proxy);O="https:"===k.protocol,w.protocol=O?"https:":"http:",w.path=t,w.headers.Host=w.host,w.hostname=k.hostname,w.host=k.host,w.port=k.port}if(e&&e.https){for(var I in e.https)if(-1!==h.indexOf(I)){var R=e.https[I];void 0!==R&&(w[I]=R)}}e&&void 0!==e.withCredentials&&(w.withCredentials=e.withCredentials),(s=(O?n:o).request(w,function(e){if(m.connectionInProgress=!1,500===e.statusCode||502===e.statusCode||503===e.statusCode||504===e.statusCode){x("error",new p("error",{status:e.statusCode,message:e.statusMessage})),_();return}if(301===e.statusCode||302===e.statusCode||307===e.statusCode){var s,r,n=e.headers.location;if(!n){x("error",new p("error",{status:e.statusCode,message:e.statusMessage}));return}f=new URL(t).origin!==new URL(n).origin,307===e.statusCode&&(E=t),t=n,process.nextTick(S);return}if(200!==e.statusCode)return x("error",new p("error",{status:e.statusCode,message:e.statusMessage})),m.close();i=l.OPEN,e.on("close",function(){e.removeAllListeners("close"),e.removeAllListeners("end"),_()}),e.on("end",function(){e.removeAllListeners("close"),e.removeAllListeners("end"),_()}),x("open",new p("open"));var o=0,a=-1,h=0,u=0;e.on("data",function(e){if(s)e.length>s.length-u&&((h=2*s.length+e.length)>262144&&(h=s.length+e.length+262144),r=Buffer.alloc(h),s.copy(r,0,0,u),s=r),e.copy(s,u),u+=e.length;else{var i;i=s=e,c.every(function(t,e){return i[e]===t})&&(s=s.slice(c.length)),u=s.length}for(var n=0,l=u;n<l;){v&&(10===s[n]&&++n,v=!1);for(var p,f=-1,_=a,E=o;f<0&&E<l;++E)58===(p=s[E])?_<0&&(_=E-n):13===p?(v=!0,f=E-n):10===p&&(f=E-n);if(f<0){o=l-n,a=_;break}o=0,a=-1,function(e,s,r,i){if(0===i){if(y.length>0){var n=b||"message";x(n,new d(n,{data:y.slice(0,-1),lastEventId:g,origin:new URL(t).origin})),y=""}b=void 0}else if(r>0){var o=r<0,a=0,h=e.slice(s,s+(o?i:r)).toString();a=o?i:32!==e[s+r+1]?r+1:r+2,s+=a;var c=i-a,u=e.slice(s,s+c).toString();if("data"===h)y+=u+"\n";else if("event"===h)b=u;else if("id"===h)g=u;else if("retry"===h){var l=parseInt(u,10);Number.isNaN(l)||(m.reconnectInterval=l)}}}(s,n,_,f),n+=f+1}n===l?(s=void 0,u=0):n>0&&(u=(s=s.slice(n,u)).length)})})).on("error",function(t){m.connectionInProgress=!1,_(t.message)}),s.setNoDelay&&s.setNoDelay(!0),s.end()}function x(){m.listeners(arguments[0]).length>0&&m.emit.apply(m,arguments)}S(),this._close=function(){i!==l.CLOSED&&(i=l.CLOSED,s.abort&&s.abort(),s.xhr&&s.xhr.abort&&s.xhr.abort())}}function p(t,e){if(Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)for(var s in e)e.hasOwnProperty(s)&&Object.defineProperty(this,s,{writable:!1,value:e[s],enumerable:!0})}function d(t,e){for(var s in Object.defineProperty(this,"type",{writable:!1,value:t,enumerable:!0}),e)e.hasOwnProperty(s)&&Object.defineProperty(this,s,{writable:!1,value:e[s],enumerable:!0})}t.exports=l,a.inherits(l,i.EventEmitter),l.prototype.constructor=l,["open","error","message"].forEach(function(t){Object.defineProperty(l.prototype,"on"+t,{get:function(){var e=this.listeners(t)[0];return e?e._listener?e._listener:e:void 0},set:function(e){this.removeAllListeners(t),this.addEventListener(t,e)}})}),Object.defineProperty(l,"CONNECTING",{enumerable:!0,value:0}),Object.defineProperty(l,"OPEN",{enumerable:!0,value:1}),Object.defineProperty(l,"CLOSED",{enumerable:!0,value:2}),l.prototype.CONNECTING=0,l.prototype.OPEN=1,l.prototype.CLOSED=2,l.prototype.close=function(){this._close()},l.prototype.addEventListener=function(t,e){"function"==typeof e&&(e._listener=e,this.on(t,e))},l.prototype.dispatchEvent=function(t){if(!t.type)throw Error("UNSPECIFIED_EVENT_TYPE_ERR");this.emit(t.type,t.detail)},l.prototype.removeEventListener=function(t,e){"function"==typeof e&&(e._listener=void 0,this.removeListener(t,e))}},4611:(t,e,s)=>{"use strict";var r=s(7910).Stream,i=s(8354),n=s(8259),o=s(6558),a=s(8854),h=s(145),c=s(7913),u=function(t,e,s){this.writable=!0,s=s||{},this._stream=e.socket,this._ping=s.ping||this.DEFAULT_PING,this._retry=s.retry||this.DEFAULT_RETRY;var r=n.isSecureRequest(t)?"https:":"http:";this.url=r+"//"+t.headers.host+t.url,this.lastEventId=t.headers["last-event-id"]||"",this.readyState=a.CONNECTING;var i=new o,h=this;if(s.headers)for(var c in s.headers)i.set(c,s.headers[c]);if(this._stream&&this._stream.writable){process.nextTick(function(){h._open()}),this._stream.setTimeout(0),this._stream.setNoDelay(!0);var u="HTTP/1.1 200 OK\r\nContent-Type: text/event-stream\r\nCache-Control: no-cache, no-store\r\nConnection: close\r\n"+i.toString()+"\r\nretry: "+Math.floor(1e3*this._retry)+"\r\n\r\n";this._write(u),this._stream.on("drain",function(){h.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){h.ping()},1e3*this._ping)),["error","end"].forEach(function(t){h._stream.on(t,function(){h.close()})})}};i.inherits(u,r),u.isEventSource=function(t){return"GET"===t.method&&(t.headers.accept||"").split(/\s*,\s*/).indexOf("text/event-stream")>=0};var l={DEFAULT_PING:10,DEFAULT_RETRY:5,_write:function(t){if(!this.writable)return!1;try{return this._stream.write(t,"utf8")}catch(t){return!1}},_open:function(){if(this.readyState===a.CONNECTING){this.readyState=a.OPEN;var t=new c("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.write(t),this.close()},send:function(t,e){if(this.readyState>a.OPEN)return!1;t=String(t).replace(/(\r\n|\r|\n)/g,"$1data: ");var s="";return(e=e||{}).event&&(s+="event: "+e.event+"\r\n"),e.id&&(s+="id: "+e.id+"\r\n"),s+="data: "+t+"\r\n\r\n",this._write(s)},ping:function(){return this._write(":\r\n\r\n")},close:function(){if(this.readyState>a.OPEN)return!1;this.readyState=a.CLOSED,this.writable=!1,this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end();var t=new c("close");return t.initEvent("close",!1,!1),this.dispatchEvent(t),!0}};for(var p in l)u.prototype[p]=l[p];for(var d in h)u.prototype[d]=h[d];t.exports=u},7033:(t,e,s)=>{"use strict";var r=s(8354),i=s(8259),n=s(8854),o=function(t,e,s,r,o){o=o||{},this._stream=e,this._driver=i.http(t,{maxLength:o.maxLength,protocols:r});var a=this;if(this._stream&&this._stream.writable){if(!this._stream.readable)return this._stream.end();var h=function(){a._stream.removeListener("data",h)};this._stream.on("data",h),n.call(this,o),process.nextTick(function(){a._driver.start(),a._driver.io.write(s)})}};r.inherits(o,n),o.isWebSocket=function(t){return i.isWebSocket(t)},o.validateOptions=function(t,e){i.validateOptions(t,e)},o.WebSocket=o,o.Client=s(9079),o.EventSource=s(4611),t.exports=o},8854:(t,e,s)=>{"use strict";var r=s(7910).Stream,i=s(8354),n=s(8259),o=s(145),a=s(7913),h=function(t){t=t||{},n.validateOptions(t,["headers","extensions","maxLength","ping","proxy","tls","ca"]),this.readable=this.writable=!0;var e=t.headers;if(e)for(var s in e)this._driver.setHeader(s,e[s]);var r=t.extensions;r&&[].concat(r).forEach(this._driver.addExtension,this._driver),this._ping=t.ping,this._pingId=0,this.readyState=h.CONNECTING,this.bufferedAmount=0,this.protocol="",this.url=this._driver.url,this.version=this._driver.version;var i=this;this._driver.on("open",function(t){i._open()}),this._driver.on("message",function(t){i._receiveMessage(t.data)}),this._driver.on("close",function(t){i._beginClose(t.reason,t.code)}),this._driver.on("error",function(t){i._emitError(t.message)}),this.on("error",function(){}),this._driver.messages.on("drain",function(){i.emit("drain")}),this._ping&&(this._pingTimer=setInterval(function(){i._pingId+=1,i.ping(i._pingId.toString())},1e3*this._ping)),this._configureStream(),this._proxy||(this._stream.pipe(this._driver.io),this._driver.io.pipe(this._stream))};i.inherits(h,r),h.CONNECTING=0,h.OPEN=1,h.CLOSING=2,h.CLOSED=3,h.CLOSE_TIMEOUT=3e4;var c={write:function(t){return this.send(t)},end:function(t){void 0!==t&&this.send(t),this.close()},pause:function(){return this._driver.messages.pause()},resume:function(){return this._driver.messages.resume()},send:function(t){return!(this.readyState>h.OPEN)&&(t instanceof Buffer||(t=String(t)),this._driver.messages.write(t))},ping:function(t,e){return!(this.readyState>h.OPEN)&&this._driver.ping(t,e)},close:function(t,e){if(void 0===t&&(t=1e3),void 0===e&&(e=""),1e3!==t&&(t<3e3||t>4999))throw Error("Failed to execute 'close' on WebSocket: The code must be either 1000, or between 3000 and 4999. "+t+" is neither.");if(this.readyState<h.CLOSING){var s=this;this._closeTimer=setTimeout(function(){s._beginClose("",1006)},h.CLOSE_TIMEOUT)}this.readyState!==h.CLOSED&&(this.readyState=h.CLOSING),this._driver.close(e,t)},_configureStream:function(){var t=this;this._stream.setTimeout(0),this._stream.setNoDelay(!0),["close","end"].forEach(function(e){this._stream.on(e,function(){t._finalizeClose()})},this),this._stream.on("error",function(e){t._emitError("Network error: "+t.url+": "+e.message),t._finalizeClose()})},_open:function(){if(this.readyState===h.CONNECTING){this.readyState=h.OPEN,this.protocol=this._driver.protocol||"";var t=new a("open");t.initEvent("open",!1,!1),this.dispatchEvent(t)}},_receiveMessage:function(t){if(this.readyState>h.OPEN)return!1;this.readable&&this.emit("data",t);var e=new a("message",{data:t});e.initEvent("message",!1,!1),this.dispatchEvent(e)},_emitError:function(t){if(!(this.readyState>=h.CLOSING)){var e=new a("error",{message:t});e.initEvent("error",!1,!1),this.dispatchEvent(e)}},_beginClose:function(t,e){this.readyState!==h.CLOSED&&(this.readyState=h.CLOSING,this._closeParams=[t,e],this._stream&&(this._stream.destroy(),this._stream.readable||this._finalizeClose()))},_finalizeClose:function(){if(this.readyState!==h.CLOSED){this.readyState=h.CLOSED,this._closeTimer&&clearTimeout(this._closeTimer),this._pingTimer&&clearInterval(this._pingTimer),this._stream&&this._stream.end(),this.readable&&this.emit("end"),this.readable=this.writable=!1;var t=this._closeParams?this._closeParams[0]:"",e=new a("close",{code:this._closeParams?this._closeParams[1]:1006,reason:t});e.initEvent("close",!1,!1),this.dispatchEvent(e)}}};for(var u in c)h.prototype[u]=c[u];for(var l in o)h.prototype[l]=o[l];t.exports=h},7913:t=>{"use strict";var e=function(t,e){for(var s in this.type=t,e)this[s]=e[s]};e.prototype.initEvent=function(t,e,s){this.type=t,this.bubbles=e,this.cancelable=s},e.prototype.stopPropagation=function(){},e.prototype.preventDefault=function(){},e.CAPTURING_PHASE=1,e.AT_TARGET=2,e.BUBBLING_PHASE=3,t.exports=e},145:(t,e,s)=>{"use strict";var r=s(7913);t.exports={onopen:null,onmessage:null,onerror:null,onclose:null,addEventListener:function(t,e,s){this.on(t,e)},removeEventListener:function(t,e,s){this.removeListener(t,e)},dispatchEvent:function(t){t.target=t.currentTarget=this,t.eventPhase=r.AT_TARGET,this["on"+t.type]&&this["on"+t.type](t),this.emit(t.type,t)}}},9079:(t,e,s)=>{"use strict";var r=s(8354),i=s(1645),n=s(4631),o=s(9551),a=s(8259),h=s(8854);s(7913);var c={"http:":80,"https:":443,"ws:":80,"wss:":443},u=["https:","wss:"],l=function(t,e,s){s=s||{},this.url=t,this._driver=a.client(this.url,{maxLength:s.maxLength,protocols:e}),["open","error"].forEach(function(t){this._driver.on(t,function(){v.headers=v._driver.headers,v.statusCode=v._driver.statusCode})},this);var r=s.proxy||{},l=o.parse(r.origin||this.url),p=l.port||c[l.protocol],d=u.indexOf(l.protocol)>=0,f=function(){v._onConnect()},m=s.net||{},_=s.tls||{},g=r.origin?r.tls||{}:_,v=this;m.host=g.host=l.hostname,m.port=g.port=p,_.ca=_.ca||s.ca,g.servername=g.servername||l.hostname,this._stream=d?n.connect(g,f):i.connect(m,f),r.origin&&this._configureProxy(r,_),h.call(this,s)};r.inherits(l,h),l.prototype._onConnect=function(){(this._proxy||this._driver).start()},l.prototype._configureProxy=function(t,e){var s,r=o.parse(this.url),i=u.indexOf(r.protocol)>=0,a=this;if(this._proxy=this._driver.proxy(t.origin),t.headers)for(s in t.headers)this._proxy.setHeader(s,t.headers[s]);this._proxy.pipe(this._stream,{end:!1}),this._stream.pipe(this._proxy),this._proxy.on("connect",function(){if(i){var t={socket:a._stream,servername:r.hostname};for(s in e)t[s]=e[s];a._stream=n.connect(t),a._configureStream()}a._driver.io.pipe(a._stream),a._stream.pipe(a._driver.io),a._driver.start()}),this._proxy.on("error",function(t){a._driver.emit("error",t)})},t.exports=l},1077:(t,e)=>{function s(t){if(void 0!==t&&t!==s.REQUEST&&t!==s.RESPONSE)throw Error("type must be REQUEST or RESPONSE");void 0===t||this.initialize(t),this.maxHeaderSize=s.maxHeaderSize}e.e=s,s.prototype.initialize=function(t,e){if(t!==s.REQUEST&&t!==s.RESPONSE)throw Error("type must be REQUEST or RESPONSE");this.type=t,this.state=t+"_LINE",this.info={headers:[],upgrade:!1},this.trailers=[],this.line="",this.isChunked=!1,this.connection="",this.headerSize=0,this.body_bytes=null,this.isUserCall=!1,this.hadError=!1},s.encoding="ascii",s.maxHeaderSize=81920,s.REQUEST="REQUEST",s.RESPONSE="RESPONSE";var r=s.kOnHeaders=1,i=s.kOnHeadersComplete=2,n=s.kOnBody=3,o=s.kOnMessageComplete=4;s.prototype[r]=s.prototype[i]=s.prototype[n]=s.prototype[o]=function(){};var a=!0;Object.defineProperty(s,"kOnExecute",{get:function(){return a=!1,99}});var h=s.methods=["DELETE","GET","HEAD","POST","PUT","CONNECT","OPTIONS","TRACE","COPY","LOCK","MKCOL","MOVE","PROPFIND","PROPPATCH","SEARCH","UNLOCK","BIND","REBIND","UNBIND","ACL","REPORT","MKACTIVITY","CHECKOUT","MERGE","M-SEARCH","NOTIFY","SUBSCRIBE","UNSUBSCRIBE","PATCH","PURGE","MKCALENDAR","LINK","UNLINK","SOURCE"],c=h.indexOf("CONNECT");s.prototype.reinitialize=s,s.prototype.close=s.prototype.pause=s.prototype.resume=s.prototype.remove=s.prototype.free=function(){},s.prototype._compatMode0_11=!1,s.prototype.getAsyncId=function(){return 0};var u={REQUEST_LINE:!0,RESPONSE_LINE:!0,HEADER:!0};s.prototype.execute=function(t,e,r){if(!(this instanceof s))throw TypeError("not a HTTPParser");e=e||0,r="number"==typeof r?r:t.length,this.chunk=t,this.offset=e;var i=this.end=e+r;try{for(;this.offset<i&&!this[this.state](););}catch(t){if(this.isUserCall)throw t;return this.hadError=!0,t}return(this.chunk=null,r=this.offset-e,u[this.state]&&(this.headerSize+=r,this.headerSize>(this.maxHeaderSize||s.maxHeaderSize)))?Error("max header size exceeded"):r};var l={REQUEST_LINE:!0,RESPONSE_LINE:!0,BODY_RAW:!0};s.prototype.finish=function(){if(!this.hadError){if(!l[this.state])return Error("invalid state for EOF");"BODY_RAW"===this.state&&this.userCall()(this[o]())}},s.prototype.consume=s.prototype.unconsume=s.prototype.getCurrentBuffer=function(){},s.prototype.userCall=function(){this.isUserCall=!0;var t=this;return function(e){return t.isUserCall=!1,e}},s.prototype.nextRequest=function(){this.userCall()(this[o]()),this.reinitialize(this.type)},s.prototype.consumeLine=function(){for(var t=this.end,e=this.chunk,r=this.offset;r<t;r++)if(10===e[r]){var i=this.line+e.toString(s.encoding,this.offset,r);return"\r"===i.charAt(i.length-1)&&(i=i.substr(0,i.length-1)),this.line="",this.offset=r+1,i}this.line+=e.toString(s.encoding,this.offset,this.end),this.offset=this.end};var p=/^([^: \t]+):[ \t]*((?:.*[^ \t])|)/,d=/^[ \t]+(.*[^ \t])/;s.prototype.parseHeader=function(t,e){if(-1!==t.indexOf("\r"))throw _("HPE_LF_EXPECTED");var s=p.exec(t),r=s&&s[1];if(r)e.push(r),e.push(s[2]);else{var i=d.exec(t);i&&e.length&&(e[e.length-1]&&(e[e.length-1]+=" "),e[e.length-1]+=i[1])}};var f=/^([A-Z-]+) ([^ ]+) HTTP\/(\d)\.(\d)$/;s.prototype.REQUEST_LINE=function(){var t=this.consumeLine();if(t){var e=f.exec(t);if(null===e)throw _("HPE_INVALID_CONSTANT");if(this.info.method=this._compatMode0_11?e[1]:h.indexOf(e[1]),-1===this.info.method)throw Error("invalid request method");this.info.url=e[2],this.info.versionMajor=+e[3],this.info.versionMinor=+e[4],this.body_bytes=0,this.state="HEADER"}};var m=/^HTTP\/(\d)\.(\d) (\d{3}) ?(.*)$/;function _(t){var e=Error("Parse Error");return e.code=t,e}s.prototype.RESPONSE_LINE=function(){var t=this.consumeLine();if(t){var e=m.exec(t);if(null===e)throw _("HPE_INVALID_CONSTANT");this.info.versionMajor=+e[1],this.info.versionMinor=+e[2];var s=this.info.statusCode=+e[3];this.info.statusMessage=e[4],((s/100|0)==1||204===s||304===s)&&(this.body_bytes=0),this.state="HEADER"}},s.prototype.shouldKeepAlive=function(){if(this.info.versionMajor>0&&this.info.versionMinor>0){if(-1!==this.connection.indexOf("close"))return!1}else if(-1===this.connection.indexOf("keep-alive"))return!1;return null!==this.body_bytes||!!this.isChunked},s.prototype.HEADER=function(){var t=this.consumeLine();if(void 0!==t){var e=this.info;if(t)this.parseHeader(t,e.headers);else{for(var r,n,o=e.headers,h=!1,u=!1,l=0;l<o.length;l+=2)switch(o[l].toLowerCase()){case"transfer-encoding":this.isChunked="chunked"===o[l+1].toLowerCase();break;case"content-length":if(r=+o[l+1],h){if(r!==this.body_bytes)throw _("HPE_UNEXPECTED_CONTENT_LENGTH")}else h=!0,this.body_bytes=r;break;case"connection":this.connection+=o[l+1].toLowerCase();break;case"upgrade":u=!0}if(this.isChunked&&h&&(h=!1,this.body_bytes=null),u&&-1!=this.connection.indexOf("upgrade")?e.upgrade=this.type===s.REQUEST||101===e.statusCode:e.upgrade=e.method===c,this.isChunked&&e.upgrade&&(this.isChunked=!1),e.shouldKeepAlive=this.shouldKeepAlive(),2===(n=a?this.userCall()(this[i](e)):this.userCall()(this[i](e.versionMajor,e.versionMinor,e.headers,e.method,e.url,e.statusCode,e.statusMessage,e.upgrade,e.shouldKeepAlive))))return this.nextRequest(),!0;if(this.isChunked&&!n)this.state="BODY_CHUNKHEAD";else{if(n||0===this.body_bytes)return this.nextRequest(),e.upgrade;null===this.body_bytes?this.state="BODY_RAW":this.state="BODY_SIZED"}}}},s.prototype.BODY_CHUNKHEAD=function(){var t=this.consumeLine();void 0!==t&&(this.body_bytes=parseInt(t,16),this.body_bytes?this.state="BODY_CHUNK":this.state="BODY_CHUNKTRAILERS")},s.prototype.BODY_CHUNK=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[n](this.chunk.slice(this.offset,this.offset+t),0,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||(this.state="BODY_CHUNKEMPTYLINE")},s.prototype.BODY_CHUNKEMPTYLINE=function(){var t=this.consumeLine();if(void 0!==t){if(""!==t)throw Error("Expected empty line");this.state="BODY_CHUNKHEAD"}},s.prototype.BODY_CHUNKTRAILERS=function(){var t=this.consumeLine();void 0!==t&&(t?this.parseHeader(t,this.trailers):(this.trailers.length&&this.userCall()(this[r](this.trailers,"")),this.nextRequest()))},s.prototype.BODY_RAW=function(){this.userCall()(this[n](this.chunk.slice(this.offset,this.end),0,this.end-this.offset)),this.offset=this.end},s.prototype.BODY_SIZED=function(){var t=Math.min(this.end-this.offset,this.body_bytes);this.userCall()(this[n](this.chunk.slice(this.offset,this.offset+t),0,t)),this.offset+=t,this.body_bytes-=t,this.body_bytes||this.nextRequest()},["Headers","HeadersComplete","Body","MessageComplete"].forEach(function(t){var e=s["kOn"+t];Object.defineProperty(s.prototype,"on"+t,{get:function(){return this[e]},set:function(t){return this._compatMode0_11=!0,c="CONNECT",this[e]=t}})})},5589:(t,e,s)=>{try{var r=s(8354);if("function"!=typeof r.inherits)throw"";t.exports=r.inherits}catch(e){t.exports=s(2866)}},2866:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t}}},6436:(t,e)=>{"use strict";var s,r=Object.prototype.hasOwnProperty;function i(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}function n(t){try{return encodeURIComponent(t)}catch(t){return null}}e.stringify=function(t,e){var i,o,a=[];for(o in"string"!=typeof(e=e||"")&&(e="?"),t)if(r.call(t,o)){if(!(i=t[o])&&(null===i||i===s||isNaN(i))&&(i=""),o=n(o),i=n(i),null===o||null===i)continue;a.push(o+"="+i)}return a.length?e+a.join("&"):""},e.parse=function(t){for(var e,s=/([^=?#&]+)=?([^&]*)/g,r={};e=s.exec(t);){var n=i(e[1]),o=i(e[2]);null===n||null===o||n in r||(r[n]=o)}return r}},4911:t=>{"use strict";t.exports=function(t,e){if(e=e.split(":")[0],!(t=+t))return!1;switch(e){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}},6233:(t,e,s)=>{var r=s(9428),i=r.Buffer;function n(t,e){for(var s in t)e[s]=t[s]}function o(t,e,s){return i(t,e,s)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(n(r,e),e.Buffer=o),o.prototype=Object.create(i.prototype),n(i,o),o.from=function(t,e,s){if("number"==typeof t)throw TypeError("Argument must not be a number");return i(t,e,s)},o.alloc=function(t,e,s){if("number"!=typeof t)throw TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof s?r.fill(e,s):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return i(t)},o.allocUnsafeSlow=function(t){if("number"!=typeof t)throw TypeError("Argument must be a number");return r.SlowBuffer(t)}},4306:(t,e,s)=>{"use strict";var r=s(6900);t.exports=s(2687)(r),"_sockjs_onload"in global&&setTimeout(global._sockjs_onload,1)},9209:(t,e,s)=>{"use strict";var r=s(5589),i=s(1145);function n(){i.call(this),this.initEvent("close",!1,!1),this.wasClean=!1,this.code=0,this.reason=""}r(n,i),t.exports=n},1145:t=>{"use strict";function e(t){this.type=t}e.prototype.initEvent=function(t,e,s){return this.type=t,this.bubbles=e,this.cancelable=s,this.timeStamp=+new Date,this},e.prototype.stopPropagation=function(){},e.prototype.preventDefault=function(){},e.CAPTURING_PHASE=1,e.AT_TARGET=2,e.BUBBLING_PHASE=3,t.exports=e},2204:t=>{"use strict";function e(){this._listeners={}}e.prototype.addEventListener=function(t,e){t in this._listeners||(this._listeners[t]=[]);var s=this._listeners[t];-1===s.indexOf(e)&&(s=s.concat([e])),this._listeners[t]=s},e.prototype.removeEventListener=function(t,e){var s=this._listeners[t];if(s){var r=s.indexOf(e);if(-1!==r){s.length>1?this._listeners[t]=s.slice(0,r).concat(s.slice(r+1)):delete this._listeners[t];return}}},e.prototype.dispatchEvent=function(){var t=arguments[0],e=t.type,s=1==arguments.length?[t]:Array.apply(null,arguments);if(this["on"+e]&&this["on"+e].apply(this,s),e in this._listeners)for(var r=this._listeners[e],i=0;i<r.length;i++)r[i].apply(this,s)},t.exports=e},4469:(t,e,s)=>{"use strict";var r=s(5589),i=s(1145);function n(t){i.call(this),this.initEvent("message",!1,!1),this.data=t}r(n,i),t.exports=n},7550:(t,e,s)=>{"use strict";var r=s(4746);function i(t){this._transport=t,t.on("message",this._transportMessage.bind(this)),t.on("close",this._transportClose.bind(this))}i.prototype._transportClose=function(t,e){r.postMessage("c",JSON.stringify([t,e]))},i.prototype._transportMessage=function(t){r.postMessage("t",t)},i.prototype._send=function(t){this._transport.send(t)},i.prototype._close=function(){this._transport.close(),this._transport.removeAllListeners()},t.exports=i},4943:(t,e,s)=>{"use strict";var r=s(4533),i=s(6600),n=s(7550),o=s(9863),a=s(4746),h=s(6519),c=function(){};t.exports=function(t,e){var s,u={};e.forEach(function(t){t.facadeTransport&&(u[t.facadeTransport.transportName]=t.facadeTransport)}),u[o.transportName]=o,t.bootstrap_iframe=function(){var e;a.currentWindowId=h.hash.slice(1),i.attachEvent("message",function(i){if(i.source===parent&&(void 0===s&&(s=i.origin),i.origin===s)){try{o=JSON.parse(i.data)}catch(t){c("bad json",i.data);return}if(o.windowId===a.currentWindowId)switch(o.type){case"s":try{l=JSON.parse(o.data)}catch(t){c("bad json",o.data);break}var o,l,p=l[0],d=l[1],f=l[2],m=l[3];if(c(p,d,f,m),p!==t.version)throw Error('Incompatible SockJS! Main site uses: "'+p+'", the iframe: "'+t.version+'".');if(!r.isOriginEqual(f,h.href)||!r.isOriginEqual(m,h.href))throw Error("Can't connect to different domain from within an iframe. ("+h.href+", "+f+", "+m+")");e=new n(new u[d](f,m));break;case"m":e._send(o.data);break;case"c":e&&e._close(),e=null}}}),a.postMessage("s")}}},2431:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter,i=s(5589),n=s(7681),o=function(){};function a(t,e){r.call(this);var s=this,i=+new Date;this.xo=new e("GET",t),this.xo.once("finish",function(t,e){var r,a;if(200===t){if(a=+new Date-i,e)try{r=JSON.parse(e)}catch(t){o("bad json",e)}n.isObject(r)||(r={})}s.emit("finish",r,a),s.removeAllListeners()})}i(a,r),a.prototype.close=function(){this.removeAllListeners(),this.xo.close()},t.exports=a},9863:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=s(9300),o=s(2431);function a(t){var e=this;i.call(this),this.ir=new o(t,n),this.ir.once("finish",function(t,s){e.ir=null,e.emit("message",JSON.stringify([t,s]))})}r(a,i),a.transportName="iframe-info-receiver",a.prototype.close=function(){this.ir&&(this.ir.close(),this.ir=null),this.removeAllListeners()},t.exports=a},4697:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter,i=s(5589),n=s(6600),o=s(3798),a=s(9863),h=function(){};function c(t,e){var s=this;r.call(this);var i=function(){var r=s.ifr=new o(a.transportName,e,t);r.once("message",function(t){if(t){try{e=JSON.parse(t)}catch(e){h("bad json",t),s.emit("finish"),s.close();return}var e,r=e[0],i=e[1];s.emit("finish",r,i)}s.close()}),r.once("close",function(){s.emit("finish"),s.close()})};global.document.body?i():n.attachEvent("load",i)}i(c,r),c.enabled=function(){return o.enabled()},c.prototype.close=function(){this.ifr&&this.ifr.close(),this.removeAllListeners(),this.ifr=null},t.exports=c},72:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter,i=s(5589),n=s(4533),o=s(5741),a=s(6994),h=s(9300),c=s(8290),u=s(4697),l=s(2431),p=function(){};function d(t,e){p(t);var s=this;r.call(this),setTimeout(function(){s.doXhr(t,e)},0)}i(d,r),d._getReceiver=function(t,e,s){return s.sameOrigin?new l(e,h):a.enabled?new l(e,a):o.enabled&&s.sameScheme?new l(e,o):u.enabled()?new u(t,e):new l(e,c)},d.prototype.doXhr=function(t,e){var s=this,r=n.addPath(t,"/info");p("doXhr",r),this.xo=d._getReceiver(t,r,e),this.timeoutRef=setTimeout(function(){p("timeout"),s._cleanup(!1),s.emit("finish")},d.timeout),this.xo.once("finish",function(t,e){p("finish",t,e),s._cleanup(!0),s.emit("finish",t,e)})},d.prototype._cleanup=function(t){p("_cleanup"),clearTimeout(this.timeoutRef),this.timeoutRef=null,!t&&this.xo&&this.xo.close(),this.xo=null},d.prototype.close=function(){p("close"),this.removeAllListeners(),this._cleanup(!1)},d.timeout=8e3,t.exports=d},6519:t=>{"use strict";t.exports=global.location||{origin:"http://localhost:80",protocol:"http:",host:"localhost",port:80,href:"http://localhost/",hash:""}},2687:(t,e,s)=>{"use strict";s(9792);var r,i=s(540),n=s(5589),o=s(3833),a=s(301),h=s(4533),c=s(6600),u=s(1129),l=s(7681),p=s(7320),d=s(474),f=s(1145),m=s(2204),_=s(6519),g=s(9209),v=s(4469),y=s(72),b=function(){};function E(t,e,s){if(!(this instanceof E))return new E(t,e,s);if(arguments.length<1)throw TypeError("Failed to construct 'SockJS: 1 argument required, but only 0 present");m.call(this),this.readyState=E.CONNECTING,this.extensions="",this.protocol="",(s=s||{}).protocols_whitelist&&d.warn("'protocols_whitelist' is DEPRECATED. Use 'transports' instead."),this._transportsWhitelist=s.transports,this._transportOptions=s.transportOptions||{},this._timeout=s.timeout||0;var r=s.sessionId||8;if("function"==typeof r)this._generateSessionId=r;else if("number"==typeof r)this._generateSessionId=function(){return o.string(r)};else throw TypeError("If sessionId is used in the options, it needs to be a number or a function.");this._server=s.server||o.numberString(1e3);var n=new i(t);if(n.host&&n.protocol){if(n.hash)throw SyntaxError("The URL must not contain a fragment");if("http:"!==n.protocol&&"https:"!==n.protocol)throw SyntaxError("The URL's scheme must be either 'http:' or 'https:'. '"+n.protocol+"' is not allowed.")}else throw SyntaxError("The URL '"+t+"' is invalid");var a="https:"===n.protocol;if("https:"===_.protocol&&!a&&!h.isLoopbackAddr(n.hostname))throw Error("SecurityError: An insecure SockJS connection may not be initiated from a page loaded over HTTPS");e?Array.isArray(e)||(e=[e]):e=[];var c=e.sort();c.forEach(function(t,e){if(!t)throw SyntaxError("The protocols entry '"+t+"' is invalid.");if(e<c.length-1&&t===c[e+1])throw SyntaxError("The protocols entry '"+t+"' is duplicated.")});var u=h.getOrigin(_.href);this._origin=u?u.toLowerCase():null,n.set("pathname",n.pathname.replace(/\/+$/,"")),this.url=n.href,b("using url",this.url),this._urlInfo={nullOrigin:!p.hasDomain(),sameOrigin:h.isOriginEqual(this.url,_.href),sameScheme:h.isSchemeEqual(this.url,_.href)},this._ir=new y(this.url,this._urlInfo),this._ir.once("finish",this._receiveInfo.bind(this))}function S(t){return 1e3===t||t>=3e3&&t<=4999}n(E,m),E.prototype.close=function(t,e){if(t&&!S(t))throw Error("InvalidAccessError: Invalid code");if(e&&e.length>123)throw SyntaxError("reason argument has an invalid length");this.readyState!==E.CLOSING&&this.readyState!==E.CLOSED&&this._close(t||1e3,e||"Normal closure",!0)},E.prototype.send=function(t){if("string"!=typeof t&&(t=""+t),this.readyState===E.CONNECTING)throw Error("InvalidStateError: The connection has not been established yet");this.readyState===E.OPEN&&this._transport.send(a.quote(t))},E.version=s(2234),E.CONNECTING=0,E.OPEN=1,E.CLOSING=2,E.CLOSED=3,E.prototype._receiveInfo=function(t,e){if(b("_receiveInfo",e),this._ir=null,!t){this._close(1002,"Cannot connect to server");return}this._rto=this.countRTO(e),this._transUrl=t.base_url?t.base_url:this.url,b("info",t=l.extend(t,this._urlInfo));var s=r.filterToEnabled(this._transportsWhitelist,t);this._transports=s.main,b(this._transports.length+" enabled transports"),this._connect()},E.prototype._connect=function(){for(var t=this._transports.shift();t;t=this._transports.shift()){if(b("attempt",t.transportName),t.needBody&&(!global.document.body||void 0!==global.document.readyState&&"complete"!==global.document.readyState&&"interactive"!==global.document.readyState)){b("waiting for body"),this._transports.unshift(t),c.attachEvent("load",this._connect.bind(this));return}var e=Math.max(this._timeout,this._rto*t.roundTrips||5e3);this._transportTimeoutId=setTimeout(this._transportTimeout.bind(this),e),b("using timeout",e);var s=h.addPath(this._transUrl,"/"+this._server+"/"+this._generateSessionId()),r=this._transportOptions[t.transportName];b("transport url",s);var i=new t(s,this._transUrl,r);i.on("message",this._transportMessage.bind(this)),i.once("close",this._transportClose.bind(this)),i.transportName=t.transportName,this._transport=i;return}this._close(2e3,"All transports failed",!1)},E.prototype._transportTimeout=function(){b("_transportTimeout"),this.readyState===E.CONNECTING&&(this._transport&&this._transport.close(),this._transportClose(2007,"Transport timed out"))},E.prototype._transportMessage=function(t){b("_transportMessage",t);var e,s=this,r=t.slice(0,1),i=t.slice(1);switch(r){case"o":this._open();return;case"h":this.dispatchEvent(new f("heartbeat")),b("heartbeat",this.transport);return}if(i)try{e=JSON.parse(i)}catch(t){b("bad json",i)}if(void 0===e){b("empty payload",i);return}switch(r){case"a":Array.isArray(e)&&e.forEach(function(t){b("message",s.transport,t),s.dispatchEvent(new v(t))});break;case"m":b("message",this.transport,e),this.dispatchEvent(new v(e));break;case"c":Array.isArray(e)&&2===e.length&&this._close(e[0],e[1],!0)}},E.prototype._transportClose=function(t,e){if(b("_transportClose",this.transport,t,e),this._transport&&(this._transport.removeAllListeners(),this._transport=null,this.transport=null),!S(t)&&2e3!==t&&this.readyState===E.CONNECTING){this._connect();return}this._close(t,e)},E.prototype._open=function(){b("_open",this._transport&&this._transport.transportName,this.readyState),this.readyState===E.CONNECTING?(this._transportTimeoutId&&(clearTimeout(this._transportTimeoutId),this._transportTimeoutId=null),this.readyState=E.OPEN,this.transport=this._transport.transportName,this.dispatchEvent(new f("open")),b("connected",this.transport)):this._close(1006,"Server lost session")},E.prototype._close=function(t,e,s){b("_close",this.transport,t,e,s,this.readyState);var r=!1;if(this._ir&&(r=!0,this._ir.close(),this._ir=null),this._transport&&(this._transport.close(),this._transport=null,this.transport=null),this.readyState===E.CLOSED)throw Error("InvalidStateError: SockJS has already been closed");this.readyState=E.CLOSING,setTimeout((function(){this.readyState=E.CLOSED,r&&this.dispatchEvent(new f("error"));var i=new g("close");i.wasClean=s||!1,i.code=t||1e3,i.reason=e,this.dispatchEvent(i),this.onmessage=this.onclose=this.onerror=null,b("disconnected")}).bind(this),0)},E.prototype.countRTO=function(t){return t>100?4*t:300+t},t.exports=function(t){return r=u(t),s(4943)(E,t),E}},9792:()=>{"use strict";var t,e=Array.prototype,s=Object.prototype,r=Function.prototype,i=String.prototype,n=e.slice,o=s.toString,a=function(t){return"[object Function]"===s.toString.call(t)},h=function(t){return"[object String]"===o.call(t)};t=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}()?function(t,e,s,r){!r&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:s})}:function(t,e,s,r){!r&&e in t||(t[e]=s)};var c=function(e,r,i){for(var n in r)s.hasOwnProperty.call(r,n)&&t(e,n,r[n],i)},u=function(t){if(null==t)throw TypeError("can't convert "+t+" to object");return Object(t)};function l(){}c(r,{bind:function(t){var e=this;if(!a(e))throw TypeError("Function.prototype.bind called on incompatible "+e);for(var s=n.call(arguments,1),r=Math.max(0,e.length-s.length),i=[],o=0;o<r;o++)i.push("$"+o);var h=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this, arguments); }")(function(){if(!(this instanceof h))return e.apply(t,s.concat(n.call(arguments)));var r=e.apply(this,s.concat(n.call(arguments)));return Object(r)===r?r:this});return e.prototype&&(l.prototype=e.prototype,h.prototype=new l,l.prototype=null),h}}),c(Array,{isArray:function(t){return"[object Array]"===o.call(t)}});var p=Object("a"),d="a"!==p[0]||!(0 in p);c(e,{forEach:function(t){var e=u(this),s=d&&h(this)?this.split(""):e,r=arguments[1],i=-1,n=s.length>>>0;if(!a(t))throw TypeError();for(;++i<n;)i in s&&t.call(r,s[i],i,e)}},!function(t){var e=!0,s=!0;return t&&(t.call("foo",function(t,s,r){"object"!=typeof r&&(e=!1)}),t.call([1],function(){s="string"==typeof this},"x")),!!t&&e&&s}(e.forEach)),c(e,{indexOf:function(t){var e,s,r=d&&h(this)?this.split(""):u(this),i=r.length>>>0;if(!i)return -1;var n=0;for(arguments.length>1&&(e=arguments[1],(s=+e)!=s?s=0:0!==s&&s!==1/0&&s!==-1/0&&(s=(s>0||-1)*Math.floor(Math.abs(s))),n=s),n=n>=0?n:Math.max(0,i+n);n<i;n++)if(n in r&&r[n]===t)return n;return -1}},Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2));var f=i.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?function(){var t=void 0===/()??/.exec("")[1];i.split=function(s,r){var i=this;if(void 0===s&&0===r)return[];if("[object RegExp]"!==o.call(s))return f.call(this,s,r);var n,a,h,c,u=[],l=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.extended?"x":"")+(s.sticky?"y":""),p=0;for(s=RegExp(s.source,l+"g"),i+="",t||(n=RegExp("^"+s.source+"$(?!\\s)",l)),r=void 0===r?0xffffffff:r>>>0;(a=s.exec(i))&&(!((h=a.index+a[0].length)>p)||(u.push(i.slice(p,a.index)),!t&&a.length>1&&a[0].replace(n,function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(a[t]=void 0)}),a.length>1&&a.index<i.length&&e.push.apply(u,a.slice(1)),c=a[0].length,p=h,!(u.length>=r)));)s.lastIndex===a.index&&s.lastIndex++;return p===i.length?(c||!s.test(""))&&u.push(""):u.push(i.slice(p)),u.length>r?u.slice(0,r):u}}():"0".split(void 0,0).length&&(i.split=function(t,e){return void 0===t&&0===e?[]:f.call(this,t,e)});var m=i.substr;c(i,{substr:function(t,e){return m.call(this,t<0&&(t=this.length+t)<0?0:t,e)}},"".substr&&"b"!=="0b".substr(-1))},6900:(t,e,s)=>{"use strict";t.exports=[s(1283),s(899),s(7135),s(1565),s(6711)(s(1565)),s(2993),s(6711)(s(2993)),s(7304),s(548),s(6711)(s(7304)),s(1844)]},7564:(t,e,s)=>{t.exports=s(7033).Client},2737:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter,i=s(5589),n=s(1630),o=s(5591),a=s(540),h=function(){};function c(t,e,s,i){h(t,e,s);var c=this;r.call(this);var u=new a(e),l={method:t,hostname:u.hostname.replace(/\[|\]/g,""),port:u.port,path:u.pathname+(u.query||""),headers:i&&i.headers},p="https:"===u.protocol?o:n;this.req=p.request(l,function(t){t.setEncoding("utf8");var e="";t.on("data",function(t){h("data",t),e+=t,c.emit("chunk",200,e)}),t.once("end",function(){h("end"),c.emit("finish",t.statusCode,e),c.req=null})}),this.req.on("error",function(t){h("error",t),c.emit("finish",0,t.message)}),s&&this.req.write(s),this.req.end()}i(c,r),c.prototype.close=function(){h("close"),this.removeAllListeners(),this.req&&(this.req.abort(),this.req=null)},c.enabled=!0,c.supportsCORS=!0,t.exports=c},1565:(t,e,s)=>{"use strict";var r=s(5589),i=s(426),n=s(1589),o=s(6994),a=s(7219);function h(t){if(!h.enabled())throw Error("Transport created when disabled");i.call(this,t,"/eventsource",n,o)}r(h,i),h.enabled=function(){return!!a},h.transportName="eventsource",h.roundTrips=2,t.exports=h},2993:(t,e,s)=>{"use strict";var r=s(5589),i=s(5257),n=s(9300),o=s(426);function a(t){if(!i.enabled)throw Error("Transport created when disabled");o.call(this,t,"/htmlfile",i,n)}r(a,o),a.enabled=function(t){return i.enabled&&t.sameOrigin},a.transportName="htmlfile",a.roundTrips=2,t.exports=a},3798:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=s(2234),o=s(4533),a=s(4746),h=s(6600),c=s(3833),u=function(){};function l(t,e,s){if(!l.enabled())throw Error("Transport created when disabled");i.call(this);var r=this;this.origin=o.getOrigin(s),this.baseUrl=s,this.transUrl=e,this.transport=t,this.windowId=c.string(8);var n=o.addPath(s,"/iframe.html")+"#"+this.windowId;u(t,e,n),this.iframeObj=a.createIframe(n,function(t){u("err callback"),r.emit("close",1006,"Unable to load an iframe ("+t+")"),r.close()}),this.onmessageCallback=this._message.bind(this),h.attachEvent("message",this.onmessageCallback)}r(l,i),l.prototype.close=function(){if(u("close"),this.removeAllListeners(),this.iframeObj){h.detachEvent("message",this.onmessageCallback);try{this.postMessage("c")}catch(t){}this.iframeObj.cleanup(),this.iframeObj=null,this.onmessageCallback=this.iframeObj=null}},l.prototype._message=function(t){var e,s;if(u("message",t.data),!o.isOriginEqual(t.origin,this.origin)){u("not same origin",t.origin,this.origin);return}try{e=JSON.parse(t.data)}catch(e){u("bad json",t.data);return}if(e.windowId!==this.windowId){u("mismatched window id",e.windowId,this.windowId);return}switch(e.type){case"s":this.iframeObj.loaded(),this.postMessage("s",JSON.stringify([n,this.transport,this.transUrl,this.baseUrl]));break;case"t":this.emit("message",e.data);break;case"c":try{s=JSON.parse(e.data)}catch(t){u("bad json",e.data);return}this.emit("close",s[0],s[1]),this.close()}},l.prototype.postMessage=function(t,e){u("postMessage",t,e),this.iframeObj.post(JSON.stringify({windowId:this.windowId,type:t,data:e||""}),this.origin)},l.prototype.send=function(t){u("send",t),this.postMessage("m",t)},l.enabled=function(){return a.iframeEnabled},l.transportName="iframe",l.roundTrips=2,t.exports=l},1844:(t,e,s)=>{"use strict";var r=s(5589),i=s(2733),n=s(4038),o=s(5362);function a(t){if(!a.enabled())throw Error("Transport created when disabled");i.call(this,t,"/jsonp",o,n)}r(a,i),a.enabled=function(){return!!global.document},a.transportName="jsonp-polling",a.roundTrips=1,a.needBody=!0,t.exports=a},426:(t,e,s)=>{"use strict";var r=s(5589),i=s(4533),n=s(2733),o=function(){};function a(t,e,s,r){n.call(this,t,e,function(t,e,s){o("create ajax sender",t,e);var n={};"string"==typeof e&&(n.headers={"Content-type":"text/plain"});var a=new r("POST",i.addPath(t,"/xhr_send"),e,n);return a.once("finish",function(t){if(o("finish",t),a=null,200!==t&&204!==t)return s(Error("http status "+t));s()}),function(){o("abort"),a.close(),a=null;var t=Error("Aborted");t.code=1e3,s(t)}},s,r)}r(a,n),t.exports=a},5979:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=function(){};function o(t,e){n(t),i.call(this),this.sendBuffer=[],this.sender=e,this.url=t}r(o,i),o.prototype.send=function(t){n("send",t),this.sendBuffer.push(t),this.sendStop||this.sendSchedule()},o.prototype.sendScheduleWait=function(){n("sendScheduleWait");var t,e=this;this.sendStop=function(){n("sendStop"),e.sendStop=null,clearTimeout(t)},t=setTimeout(function(){n("timeout"),e.sendStop=null,e.sendSchedule()},25)},o.prototype.sendSchedule=function(){n("sendSchedule",this.sendBuffer.length);var t=this;if(this.sendBuffer.length>0){var e="["+this.sendBuffer.join(",")+"]";this.sendStop=this.sender(this.url,e,function(e){t.sendStop=null,e?(n("error",e),t.emit("close",e.code||1006,"Sending error: "+e),t.close()):t.sendScheduleWait()}),this.sendBuffer=[]}},o.prototype._cleanup=function(){n("_cleanup"),this.removeAllListeners()},o.prototype.close=function(){n("close"),this._cleanup(),this.sendStop&&(this.sendStop(),this.sendStop=null)},t.exports=o},6711:(t,e,s)=>{"use strict";var r=s(5589),i=s(3798),n=s(7681);t.exports=function(t){function e(e,s){i.call(this,t.transportName,e,s)}return r(e,i),e.enabled=function(e,s){if(!global.document)return!1;var r=n.extend({},s);return r.sameOrigin=!0,t.enabled(r)&&i.enabled()},e.transportName="iframe-"+t.transportName,e.needBody=!0,e.roundTrips=i.roundTrips+t.roundTrips-1,e.facadeTransport=t,e}},7543:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=function(){};function o(t,e,s){n(e),i.call(this),this.Receiver=t,this.receiveUrl=e,this.AjaxObject=s,this._scheduleReceiver()}r(o,i),o.prototype._scheduleReceiver=function(){n("_scheduleReceiver");var t=this,e=this.poll=new this.Receiver(this.receiveUrl,this.AjaxObject);e.on("message",function(e){n("message",e),t.emit("message",e)}),e.once("close",function(s,r){n("close",s,r,t.pollIsClosing),t.poll=e=null,t.pollIsClosing||("network"===r?t._scheduleReceiver():(t.emit("close",s||1006,r),t.removeAllListeners()))})},o.prototype.abort=function(){n("abort"),this.removeAllListeners(),this.pollIsClosing=!0,this.poll&&this.poll.abort()},t.exports=o},2733:(t,e,s)=>{"use strict";var r=s(5589),i=s(4533),n=s(5979),o=s(7543),a=function(){};function h(t,e,s,r,h){var c=i.addPath(t,e);a(c);var u=this;n.call(this,t,s),this.poll=new o(r,c,h),this.poll.on("message",function(t){a("poll message",t),u.emit("message",t)}),this.poll.once("close",function(t,e){a("poll close",t,e),u.poll=null,u.emit("close",t,e),u.close()})}r(h,n),h.prototype.close=function(){n.prototype.close.call(this),a("close"),this.removeAllListeners(),this.poll&&(this.poll.abort(),this.poll=null)},t.exports=h},1589:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=s(7219),o=function(){};function a(t){o(t),i.call(this);var e=this,s=this.es=new n(t);s.onmessage=function(t){o("message",t.data),e.emit("message",decodeURI(t.data))},s.onerror=function(t){o("error",s.readyState,t);var r=2!==s.readyState?"network":"permanent";e._cleanup(),e._close(r)}}r(a,i),a.prototype.abort=function(){o("abort"),this._cleanup(),this._close("user")},a.prototype._cleanup=function(){o("cleanup");var t=this.es;t&&(t.onmessage=t.onerror=null,t.close(),this.es=null)},a.prototype._close=function(t){o("close",t);var e=this;setTimeout(function(){e.emit("close",null,t),e.removeAllListeners()},200)},t.exports=a},5257:(t,e,s)=>{"use strict";var r=s(5589),i=s(4746),n=s(4533),o=s(4735).EventEmitter,a=s(3833),h=function(){};function c(t){h(t),o.call(this);var e=this;i.polluteGlobalNamespace(),this.id="a"+a.string(6),t=n.addQuery(t,"c="+decodeURIComponent(i.WPrefix+"."+this.id)),h("using htmlfile",c.htmlfileEnabled);var s=c.htmlfileEnabled?i.createHtmlfile:i.createIframe;global[i.WPrefix][this.id]={start:function(){h("start"),e.iframeObj.loaded()},message:function(t){h("message",t),e.emit("message",t)},stop:function(){h("stop"),e._cleanup(),e._close("network")}},this.iframeObj=s(t,function(){h("callback"),e._cleanup(),e._close("permanent")})}r(c,o),c.prototype.abort=function(){h("abort"),this._cleanup(),this._close("user")},c.prototype._cleanup=function(){h("_cleanup"),this.iframeObj&&(this.iframeObj.cleanup(),this.iframeObj=null),delete global[i.WPrefix][this.id]},c.prototype._close=function(t){h("_close",t),this.emit("close",null,t),this.removeAllListeners()},c.htmlfileEnabled=!1;var u=["Active"].concat("Object").join("X");if(u in global)try{c.htmlfileEnabled=(new global[u]("htmlfile"),!0)}catch(t){}c.enabled=c.htmlfileEnabled||i.iframeEnabled,t.exports=c},4038:(t,e,s)=>{"use strict";var r=s(4746),i=s(3833),n=s(7320),o=s(4533),a=s(5589),h=s(4735).EventEmitter,c=function(){};function u(t){c(t);var e=this;h.call(this),r.polluteGlobalNamespace(),this.id="a"+i.string(6);var s=o.addQuery(t,"c="+encodeURIComponent(r.WPrefix+"."+this.id));global[r.WPrefix][this.id]=this._callback.bind(this),this._createScript(s),this.timeoutId=setTimeout(function(){c("timeout"),e._abort(Error("JSONP script loaded abnormally (timeout)"))},u.timeout)}a(u,h),u.prototype.abort=function(){if(c("abort"),global[r.WPrefix][this.id]){var t=Error("JSONP user aborted read");t.code=1e3,this._abort(t)}},u.timeout=35e3,u.scriptErrorTimeout=1e3,u.prototype._callback=function(t){c("_callback",t),this._cleanup(),this.aborting||(t&&(c("message",t),this.emit("message",t)),this.emit("close",null,"network"),this.removeAllListeners())},u.prototype._abort=function(t){c("_abort",t),this._cleanup(),this.aborting=!0,this.emit("close",t.code,t.message),this.removeAllListeners()},u.prototype._cleanup=function(){if(c("_cleanup"),clearTimeout(this.timeoutId),this.script2&&(this.script2.parentNode.removeChild(this.script2),this.script2=null),this.script){var t=this.script;t.parentNode.removeChild(t),t.onreadystatechange=t.onerror=t.onload=t.onclick=null,this.script=null}delete global[r.WPrefix][this.id]},u.prototype._scriptError=function(){c("_scriptError");var t=this;this.errorTimer||(this.errorTimer=setTimeout(function(){t.loadedOkay||t._abort(Error("JSONP script loaded abnormally (onerror)"))},u.scriptErrorTimeout))},u.prototype._createScript=function(t){c("_createScript",t);var e,s=this,r=this.script=global.document.createElement("script");if(r.id="a"+i.string(8),r.src=t,r.type="text/javascript",r.charset="UTF-8",r.onerror=this._scriptError.bind(this),r.onload=function(){c("onload"),s._abort(Error("JSONP script loaded abnormally (onload)"))},r.onreadystatechange=function(){if(c("onreadystatechange",r.readyState),/loaded|closed/.test(r.readyState)){if(r&&r.htmlFor&&r.onclick){s.loadedOkay=!0;try{r.onclick()}catch(t){}}r&&s._abort(Error("JSONP script loaded abnormally (onreadystatechange)"))}},void 0===r.async&&global.document.attachEvent){if(n.isOpera())(e=this.script2=global.document.createElement("script")).text="try{var a = document.getElementById('"+r.id+"'); if(a)a.onerror();}catch(x){};",r.async=e.async=!1;else{try{r.htmlFor=r.id,r.event="onclick"}catch(t){}r.async=!0}}void 0!==r.async&&(r.async=!0);var o=global.document.getElementsByTagName("head")[0];o.insertBefore(r,o.firstChild),e&&o.insertBefore(e,o.firstChild)},t.exports=u},2058:(t,e,s)=>{"use strict";var r=s(5589),i=s(4735).EventEmitter,n=function(){};function o(t,e){n(t),i.call(this);var s=this;this.bufferPosition=0,this.xo=new e("POST",t,null),this.xo.on("chunk",this._chunkHandler.bind(this)),this.xo.once("finish",function(t,e){n("finish",t,e),s._chunkHandler(t,e),s.xo=null;var r=200===t?"network":"permanent";n("close",r),s.emit("close",null,r),s._cleanup()})}r(o,i),o.prototype._chunkHandler=function(t,e){if(n("_chunkHandler",t),200===t&&e)for(var s=-1;;this.bufferPosition+=s+1){var r=e.slice(this.bufferPosition);if(-1===(s=r.indexOf("\n")))break;var i=r.slice(0,s);i&&(n("message",i),this.emit("message",i))}},o.prototype._cleanup=function(){n("_cleanup"),this.removeAllListeners()},o.prototype.abort=function(){n("abort"),this.xo&&(this.xo.close(),n("close"),this.emit("close",null,"user"),this.xo=null),this._cleanup()},t.exports=o},5362:(t,e,s)=>{"use strict";var r,i,n=s(3833),o=s(4533),a=function(){};t.exports=function(t,e,s){a(t,e),r||(a("createForm"),(r=global.document.createElement("form")).style.display="none",r.style.position="absolute",r.method="POST",r.enctype="application/x-www-form-urlencoded",r.acceptCharset="UTF-8",(i=global.document.createElement("textarea")).name="d",r.appendChild(i),global.document.body.appendChild(r));var h="a"+n.string(8);r.target=h,r.action=o.addQuery(o.addPath(t,"/jsonp_send"),"i="+h);var c=function(t){a("createIframe",t);try{return global.document.createElement('<iframe name="'+t+'">')}catch(s){var e=global.document.createElement("iframe");return e.name=t,e}}(h);c.id=h,c.style.display="none",r.appendChild(c);try{i.value=e}catch(t){}r.submit();var u=function(t){a("completed",h,t),c.onerror&&(c.onreadystatechange=c.onerror=c.onload=null,setTimeout(function(){a("cleaning up",h),c.parentNode.removeChild(c),c=null},500),i.value="",s(t))};return c.onerror=function(){a("onerror",h),u()},c.onload=function(){a("onload",h),u()},c.onreadystatechange=function(t){a("onreadystatechange",h,c.readyState,t),"complete"===c.readyState&&u()},function(){a("aborted",h),u(Error("Aborted"))}}},5741:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter,i=s(5589),n=s(6600),o=s(7320),a=s(4533),h=function(){};function c(t,e,s){h(t,e);var i=this;r.call(this),setTimeout(function(){i._start(t,e,s)},0)}i(c,r),c.prototype._start=function(t,e,s){h("_start");var r=this,i=new global.XDomainRequest;e=a.addQuery(e,"t="+ +new Date),i.onerror=function(){h("onerror"),r._error()},i.ontimeout=function(){h("ontimeout"),r._error()},i.onprogress=function(){h("progress",i.responseText),r.emit("chunk",200,i.responseText)},i.onload=function(){h("load"),r.emit("finish",200,i.responseText),r._cleanup(!1)},this.xdr=i,this.unloadRef=n.unloadAdd(function(){r._cleanup(!0)});try{this.xdr.open(t,e),this.timeout&&(this.xdr.timeout=this.timeout),this.xdr.send(s)}catch(t){this._error()}},c.prototype._error=function(){this.emit("finish",0,""),this._cleanup(!1)},c.prototype._cleanup=function(t){if(h("cleanup",t),this.xdr){if(this.removeAllListeners(),n.unloadDel(this.unloadRef),this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null,t)try{this.xdr.abort()}catch(t){}this.unloadRef=this.xdr=null}},c.prototype.close=function(){h("close"),this._cleanup(!0)},c.enabled=!!(global.XDomainRequest&&o.hasDomain()),t.exports=c},6994:(t,e,s)=>{"use strict";var r=s(5589),i=s(2737);function n(t,e,s,r){i.call(this,t,e,s,r)}r(n,i),n.enabled=i.enabled&&i.supportsCORS,t.exports=n},8290:(t,e,s)=>{"use strict";var r=s(4735).EventEmitter;function i(){var t=this;r.call(this),this.to=setTimeout(function(){t.emit("finish",200,"{}")},i.timeout)}s(5589)(i,r),i.prototype.close=function(){clearTimeout(this.to)},i.timeout=2e3,t.exports=i},9300:(t,e,s)=>{"use strict";var r=s(5589),i=s(2737);function n(t,e,s){i.call(this,t,e,s,{noCredentials:!0})}r(n,i),n.enabled=i.enabled,t.exports=n},1283:(t,e,s)=>{"use strict";var r=s(6600),i=s(4533),n=s(5589),o=s(4735).EventEmitter,a=s(7564),h=function(){};function c(t,e,s){if(!c.enabled())throw Error("Transport created when disabled");o.call(this),h("constructor",t);var n=this,u=i.addPath(t,"/websocket");u="https"===u.slice(0,5)?"wss"+u.slice(5):"ws"+u.slice(4),this.url=u,this.ws=new a(this.url,[],s),this.ws.onmessage=function(t){h("message event",t.data),n.emit("message",t.data)},this.unloadRef=r.unloadAdd(function(){h("unload"),n.ws.close()}),this.ws.onclose=function(t){h("close event",t.code,t.reason),n.emit("close",t.code,t.reason),n._cleanup()},this.ws.onerror=function(t){h("error event",t),n.emit("close",1006,"WebSocket connection broken"),n._cleanup()}}n(c,o),c.prototype.send=function(t){var e="["+t+"]";h("send",e),this.ws.send(e)},c.prototype.close=function(){h("close");var t=this.ws;this._cleanup(),t&&t.close()},c.prototype._cleanup=function(){h("_cleanup");var t=this.ws;t&&(t.onmessage=t.onclose=t.onerror=null),r.unloadDel(this.unloadRef),this.unloadRef=this.ws=null,this.removeAllListeners()},c.enabled=function(){return h("enabled"),!!a},c.transportName="websocket",c.roundTrips=2,t.exports=c},548:(t,e,s)=>{"use strict";var r=s(5589),i=s(426),n=s(7135),o=s(2058),a=s(5741);function h(t){if(!a.enabled)throw Error("Transport created when disabled");i.call(this,t,"/xhr",o,a)}r(h,i),h.enabled=n.enabled,h.transportName="xdr-polling",h.roundTrips=2,t.exports=h},7135:(t,e,s)=>{"use strict";var r=s(5589),i=s(426),n=s(2058),o=s(5741);function a(t){if(!o.enabled)throw Error("Transport created when disabled");i.call(this,t,"/xhr_streaming",n,o)}r(a,i),a.enabled=function(t){return!t.cookie_needed&&!t.nullOrigin&&o.enabled&&t.sameScheme},a.transportName="xdr-streaming",a.roundTrips=2,t.exports=a},7304:(t,e,s)=>{"use strict";var r=s(5589),i=s(426),n=s(2058),o=s(6994),a=s(9300);function h(t){if(!a.enabled&&!o.enabled)throw Error("Transport created when disabled");i.call(this,t,"/xhr",n,o)}r(h,i),h.enabled=function(t){return!t.nullOrigin&&(!!a.enabled&&!!t.sameOrigin||o.enabled)},h.transportName="xhr-polling",h.roundTrips=2,t.exports=h},899:(t,e,s)=>{"use strict";var r=s(5589),i=s(426),n=s(2058),o=s(6994),a=s(9300),h=s(7320);function c(t){if(!a.enabled&&!o.enabled)throw Error("Transport created when disabled");i.call(this,t,"/xhr_streaming",n,o)}r(c,i),c.enabled=function(t){return!(t.nullOrigin||h.isOpera())&&o.enabled},c.transportName="xhr-streaming",c.roundTrips=2,c.needBody=!!global.document,t.exports=c},7320:t=>{"use strict";t.exports={isOpera:function(){return global.navigator&&/opera/i.test(global.navigator.userAgent)},isKonqueror:function(){return global.navigator&&/konqueror/i.test(global.navigator.userAgent)},hasDomain:function(){if(!global.document)return!0;try{return!!global.document.domain}catch(t){return!1}}}},301:t=>{"use strict";var e,s=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,r=function(t){var e,s={},r=[];for(e=0;e<65536;e++)r.push(String.fromCharCode(e));return t.lastIndex=0,r.join("").replace(t,function(t){return s[t]="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4),""}),t.lastIndex=0,s};t.exports={quote:function(t){var i=JSON.stringify(t);return(s.lastIndex=0,s.test(i))?(e||(e=r(s)),i.replace(s,function(t){return e[t]})):i}}},6600:(t,e,s)=>{"use strict";var r=s(3833),i={},n=!1,o=global.chrome&&global.chrome.app&&global.chrome.app.runtime;t.exports={attachEvent:function(t,e){void 0!==global.addEventListener?global.addEventListener(t,e,!1):global.document&&global.attachEvent&&(global.document.attachEvent("on"+t,e),global.attachEvent("on"+t,e))},detachEvent:function(t,e){void 0!==global.addEventListener?global.removeEventListener(t,e,!1):global.document&&global.detachEvent&&(global.document.detachEvent("on"+t,e),global.detachEvent("on"+t,e))},unloadAdd:function(t){if(o)return null;var e=r.string(8);return i[e]=t,n&&setTimeout(this.triggerUnloadCallbacks,0),e},unloadDel:function(t){t in i&&delete i[t]},triggerUnloadCallbacks:function(){for(var t in i)i[t](),delete i[t]}},o||t.exports.attachEvent("unload",function(){n||(n=!0,t.exports.triggerUnloadCallbacks())})},4746:(t,e,s)=>{"use strict";var r=s(6600),i=s(7320),n=function(){};t.exports={WPrefix:"_jp",currentWindowId:null,polluteGlobalNamespace:function(){t.exports.WPrefix in global||(global[t.exports.WPrefix]={})},postMessage:function(e,s){global.parent!==global?global.parent.postMessage(JSON.stringify({windowId:t.exports.currentWindowId,type:e,data:s||""}),"*"):n("Cannot postMessage, no parent window.",e,s)},createIframe:function(t,e){var s,i,o=global.document.createElement("iframe"),a=function(){n("unattach"),clearTimeout(s);try{o.onload=null}catch(t){}o.onerror=null},h=function(){n("cleanup"),o&&(a(),setTimeout(function(){o&&o.parentNode.removeChild(o),o=null},0),r.unloadDel(i))},c=function(t){n("onerror",t),o&&(h(),e(t))};return o.src=t,o.style.display="none",o.style.position="absolute",o.onerror=function(){c("onerror")},o.onload=function(){n("onload"),clearTimeout(s),s=setTimeout(function(){c("onload timeout")},2e3)},global.document.body.appendChild(o),s=setTimeout(function(){c("timeout")},15e3),i=r.unloadAdd(h),{post:function(t,e){n("post",t,e),setTimeout(function(){try{o&&o.contentWindow&&o.contentWindow.postMessage(t,e)}catch(t){}},0)},cleanup:h,loaded:a}},createHtmlfile:function(e,s){var i,o,a,h=["Active"].concat("Object").join("X"),c=new global[h]("htmlfile"),u=function(){clearTimeout(i),a.onerror=null},l=function(){c&&(u(),r.unloadDel(o),a.parentNode.removeChild(a),a=c=null,CollectGarbage())},p=function(t){n("onerror",t),c&&(l(),s(t))};c.open(),c.write('<html><script>document.domain="'+global.document.domain+'";<\/script></html>'),c.close(),c.parentWindow[t.exports.WPrefix]=global[t.exports.WPrefix];var d=c.createElement("div");return c.body.appendChild(d),a=c.createElement("iframe"),d.appendChild(a),a.src=e,a.onerror=function(){p("onerror")},i=setTimeout(function(){p("timeout")},15e3),o=r.unloadAdd(l),{post:function(t,e){try{setTimeout(function(){a&&a.contentWindow&&a.contentWindow.postMessage(t,e)},0)}catch(t){}},cleanup:l,loaded:u}}},t.exports.iframeEnabled=!1,global.document&&(t.exports.iframeEnabled=("function"==typeof global.postMessage||"object"==typeof global.postMessage)&&!i.isKonqueror())},474:t=>{"use strict";var e={};["log","debug","warn"].forEach(function(t){var s;try{s=global.console&&global.console[t]&&global.console[t].apply}catch(t){}e[t]=s?function(){return global.console[t].apply(global.console,arguments)}:"log"===t?function(){}:e.log}),t.exports=e},7681:t=>{"use strict";t.exports={isObject:function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},extend:function(t){if(!this.isObject(t))return t;for(var e,s,r=1,i=arguments.length;r<i;r++)for(s in e=arguments[r])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}}},3833:(t,e,s)=>{"use strict";var r=s(5511),i="abcdefghijklmnopqrstuvwxyz012345";t.exports={string:function(t){for(var e=i.length,s=r.randomBytes(t),n=[],o=0;o<t;o++)n.push(i.substr(s[o]%e,1));return n.join("")},number:function(t){return Math.floor(Math.random()*t)},numberString:function(t){var e=(""+(t-1)).length;return(Array(e+1).join("0")+this.number(t)).slice(-e)}}},1129:t=>{"use strict";var e=function(){};t.exports=function(t){return{filterToEnabled:function(s,r){var i={main:[],facade:[]};return s?"string"==typeof s&&(s=[s]):s=[],t.forEach(function(t){if(t){if("websocket"===t.transportName&&!1===r.websocket){e("disabled from server","websocket");return}if(s.length&&-1===s.indexOf(t.transportName)){e("not in whitelist",t.transportName);return}t.enabled(r)?(e("enabled",t.transportName),i.main.push(t),t.facadeTransport&&i.facade.push(t.facadeTransport)):e("disabled",t.transportName)}}),i}}}},4533:(t,e,s)=>{"use strict";var r=s(540),i=function(){};t.exports={getOrigin:function(t){if(!t)return null;var e=new r(t);if("file:"===e.protocol)return null;var s=e.port;return s||(s="https:"===e.protocol?"443":"80"),e.protocol+"//"+e.hostname+":"+s},isOriginEqual:function(t,e){var s=this.getOrigin(t)===this.getOrigin(e);return i("same",t,e,s),s},isSchemeEqual:function(t,e){return t.split(":")[0]===e.split(":")[0]},addPath:function(t,e){var s=t.split("?");return s[0]+e+(s[1]?"?"+s[1]:"")},addQuery:function(t,e){return t+(-1===t.indexOf("?")?"?"+e:"&"+e)},isLoopbackAddr:function(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^\[::1\]$/.test(t)}}},2234:t=>{t.exports="1.6.1"},540:(t,e,s)=>{"use strict";var r=s(4911),i=s(6436),n=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,o=/[\n\r\t]/g,a=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,h=/:\d+$/,c=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,u=/^[a-zA-Z]:/;function l(t){return(t||"").toString().replace(n,"")}var p=[["#","hash"],["?","query"],function(t,e){return m(e.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],d={hash:1,query:1};function f(t){"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self?e=self:e={};var e,s,r=e.location||{},i={},n=typeof(t=t||r);if("blob:"===t.protocol)i=new g(unescape(t.pathname),{});else if("string"===n)for(s in i=new g(t,{}),d)delete i[s];else if("object"===n){for(s in t)s in d||(i[s]=t[s]);void 0===i.slashes&&(i.slashes=a.test(t.href))}return i}function m(t){return"file:"===t||"ftp:"===t||"http:"===t||"https:"===t||"ws:"===t||"wss:"===t}function _(t,e){t=(t=l(t)).replace(o,""),e=e||{};var s,r=c.exec(t),i=r[1]?r[1].toLowerCase():"",n=!!r[2],a=!!r[3],h=0;return n?a?(s=r[2]+r[3]+r[4],h=r[2].length+r[3].length):(s=r[2]+r[4],h=r[2].length):a?(s=r[3]+r[4],h=r[3].length):s=r[4],"file:"===i?h>=2&&(s=s.slice(2)):m(i)?s=r[4]:i?n&&(s=s.slice(2)):h>=2&&m(e.protocol)&&(s=r[4]),{protocol:i,slashes:n||m(i),slashesCount:h,rest:s}}function g(t,e,s){if(t=(t=l(t)).replace(o,""),!(this instanceof g))return new g(t,e,s);var n,a,h,c,d,v,y=p.slice(),b=typeof e,E=0;for("object"!==b&&"string"!==b&&(s=e,e=null),s&&"function"!=typeof s&&(s=i.parse),n=!(a=_(t||"",e=f(e))).protocol&&!a.slashes,this.slashes=a.slashes||n&&e.slashes,this.protocol=a.protocol||e.protocol||"",t=a.rest,("file:"===a.protocol&&(2!==a.slashesCount||u.test(t))||!a.slashes&&(a.protocol||a.slashesCount<2||!m(this.protocol)))&&(y[3]=[/(.*)/,"pathname"]);E<y.length;E++){if("function"==typeof(c=y[E])){t=c(t,this);continue}h=c[0],v=c[1],h!=h?this[v]=t:"string"==typeof h?~(d="@"===h?t.lastIndexOf(h):t.indexOf(h))&&("number"==typeof c[2]?(this[v]=t.slice(0,d),t=t.slice(d+c[2])):(this[v]=t.slice(d),t=t.slice(0,d))):(d=h.exec(t))&&(this[v]=d[1],t=t.slice(0,d.index)),this[v]=this[v]||n&&c[3]&&e[v]||"",c[4]&&(this[v]=this[v].toLowerCase())}s&&(this.query=s(this.query)),n&&e.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==e.pathname)&&(this.pathname=function(t,e){if(""===t)return e;for(var s=(e||"/").split("/").slice(0,-1).concat(t.split("/")),r=s.length,i=s[r-1],n=!1,o=0;r--;)"."===s[r]?s.splice(r,1):".."===s[r]?(s.splice(r,1),o++):o&&(0===r&&(n=!0),s.splice(r,1),o--);return n&&s.unshift(""),("."===i||".."===i)&&s.push(""),s.join("/")}(this.pathname,e.pathname)),"/"!==this.pathname.charAt(0)&&m(this.protocol)&&(this.pathname="/"+this.pathname),r(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(~(d=this.auth.indexOf(":"))?(this.username=this.auth.slice(0,d),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=this.auth.slice(d+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(this.auth)),this.auth=this.password?this.username+":"+this.password:this.username),this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString()}g.prototype={set:function(t,e,s){switch(t){case"query":"string"==typeof e&&e.length&&(e=(s||i.parse)(e)),this[t]=e;break;case"port":this[t]=e,r(e,this.protocol)?e&&(this.host=this.hostname+":"+e):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=e,this.port&&(e+=":"+this.port),this.host=e;break;case"host":this[t]=e,h.test(e)?(e=e.split(":"),this.port=e.pop(),this.hostname=e.join(":")):(this.hostname=e,this.port="");break;case"protocol":this.protocol=e.toLowerCase(),this.slashes=!s;break;case"pathname":case"hash":if(e){var n="pathname"===t?"/":"#";this[t]=e.charAt(0)!==n?n+e:e}else this[t]=e;break;case"username":case"password":this[t]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(this.username=e.slice(0,o),this.username=encodeURIComponent(decodeURIComponent(this.username)),this.password=e.slice(o+1),this.password=encodeURIComponent(decodeURIComponent(this.password))):this.username=encodeURIComponent(decodeURIComponent(e))}for(var a=0;a<p.length;a++){var c=p[a];c[4]&&(this[c[1]]=this[c[1]].toLowerCase())}return this.auth=this.password?this.username+":"+this.password:this.username,this.origin="file:"!==this.protocol&&m(this.protocol)&&this.host?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=i.stringify);var e,s=this.host,r=this.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var n=r+(this.protocol&&this.slashes||m(this.protocol)?"//":"");return this.username?(n+=this.username,this.password&&(n+=":"+this.password),n+="@"):this.password?(n+=":"+this.password,n+="@"):"file:"!==this.protocol&&m(this.protocol)&&!s&&"/"!==this.pathname&&(n+="@"),(":"===s[s.length-1]||h.test(this.hostname)&&!this.port)&&(s+=":"),n+=s+this.pathname,(e="object"==typeof this.query?t(this.query):this.query)&&(n+="?"!==e.charAt(0)?"?"+e:e),this.hash&&(n+=this.hash),n}},g.extractProtocol=_,g.location=f,g.trimLeft=l,g.qs=i,t.exports=g},8259:(t,e,s)=>{"use strict";var r=s(8891),i=s(8913),n=s(9821);t.exports={client:function(t,e){return void 0===(e=e||{}).masking&&(e.masking=!0),new i(t,e)},server:function(t){return void 0===(t=t||{}).requireMasking&&(t.requireMasking=!0),new n(t)},http:function(){return n.http.apply(n,arguments)},isSecureRequest:function(t){return n.isSecureRequest(t)},isWebSocket:function(t){return r.isWebSocket(t)},validateOptions:function(t,e){r.validateOptions(t,e)}}},8891:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(4735).EventEmitter,n=s(8354),o=s(9836),a=s(6558),h=s(118),c=function(t,e,s){i.call(this),c.validateOptions(s||{},["maxLength","masking","requireMasking","protocols"]),this._request=t,this._reader=new h,this._options=s||{},this._maxLength=this._options.maxLength||this.MAX_LENGTH,this._headers=new a,this.__queue=[],this.readyState=0,this.url=e,this.io=new o.IO(this),this.messages=new o.Messages(this),this._bindEventListeners()};n.inherits(c,i),c.isWebSocket=function(t){var e=t.headers.connection||"",s=t.headers.upgrade||"";return"GET"===t.method&&e.toLowerCase().split(/ *, */).indexOf("upgrade")>=0&&"websocket"===s.toLowerCase()},c.validateOptions=function(t,e){for(var s in t)if(0>e.indexOf(s))throw Error("Unrecognized option: "+s)};var u={MAX_LENGTH:0x3ffffff,STATES:["connecting","open","closing","closed"],_bindEventListeners:function(){var t=this;this.messages.on("error",function(){}),this.on("message",function(e){var s=t.messages;s.readable&&s.emit("data",e.data)}),this.on("error",function(e){var s=t.messages;s.readable&&s.emit("error",e)}),this.on("close",function(){var e=t.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))})},getState:function(){return this.STATES[this.readyState]||null},addExtension:function(t){return!1},setHeader:function(t,e){return!(this.readyState>0)&&(this._headers.set(t,e),!0)},start:function(){var t;if(0!==this.readyState)return!1;if(!c.isWebSocket(this._request))return this._failHandshake(Error("Not a WebSocket request"));try{t=this._handshakeResponse()}catch(t){return this._failHandshake(t)}return this._write(t),-1!==this._stage&&this._open(),!0},_failHandshake:function(t){var e=new a;return e.set("Content-Type","text/plain"),e.set("Content-Length",r.byteLength(t.message,"utf8")),e=["HTTP/1.1 400 Bad Request",e.toString(),t.message],this._write(r.from(e.join("\r\n"),"utf8")),this._fail("protocol_error",t.message),!1},text:function(t){return this.frame(t)},binary:function(t){return!1},ping:function(){return!1},pong:function(){return!1},close:function(t,e){return 1===this.readyState&&(this.readyState=3,this.emit("close",new c.CloseEvent(null,null)),!0)},_open:function(){this.readyState=1,this.__queue.forEach(function(t){this.frame.apply(this,t)},this),this.__queue=[],this.emit("open",new c.OpenEvent)},_queue:function(t){return this.__queue.push(t),!0},_write:function(t){var e=this.io;e.readable&&e.emit("data",t)},_fail:function(t,e){this.readyState=2,this.emit("error",Error(e)),this.close()}};for(var l in u)c.prototype[l]=u[l];c.ConnectEvent=function(){},c.OpenEvent=function(){},c.CloseEvent=function(t,e){this.code=t,this.reason=e},c.MessageEvent=function(t){this.data=t},c.PingEvent=function(t){this.data=t},c.PongEvent=function(t){this.data=t},t.exports=c},8913:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(5511),n=s(9551),o=s(8354),a=s(9751),h=s(8891),c=s(3528),u=s(208),l=function(t,e){this.version="hybi-"+c.VERSION,c.call(this,null,t,e),this.readyState=-1,this._key=l.generateKey(),this._accept=c.generateAccept(this._key),this._http=new a("response");var s=n.parse(this.url),i=s.auth&&r.from(s.auth,"utf8").toString("base64");if(0>this.VALID_PROTOCOLS.indexOf(s.protocol))throw Error(this.url+" is not a valid WebSocket URL");this._pathname=(s.pathname||"/")+(s.search||""),this._headers.set("Host",s.host),this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Key",this._key),this._headers.set("Sec-WebSocket-Version",c.VERSION),this._protocols.length>0&&this._headers.set("Sec-WebSocket-Protocol",this._protocols.join(", ")),i&&this._headers.set("Authorization","Basic "+i)};o.inherits(l,c),l.generateKey=function(){return i.randomBytes(16).toString("base64")};var p={VALID_PROTOCOLS:["ws:","wss:"],proxy:function(t,e){return new u(this,t,e)},start:function(){return -1===this.readyState&&(this._write(this._handshakeRequest()),this.readyState=0,!0)},parse:function(t){if(3!==this.readyState){if(this.readyState>0)return c.prototype.parse.call(this,t);this._http.parse(t),this._http.isComplete()&&(this._validateHandshake(),3!==this.readyState&&(this._open(),this.parse(this._http.body)))}},_handshakeRequest:function(){var t=this._extensions.generateOffer();t&&this._headers.set("Sec-WebSocket-Extensions",t);var e=["GET "+this._pathname+" HTTP/1.1",this._headers.toString(),""];return r.from(e.join("\r\n"),"utf8")},_failHandshake:function(t){t="Error during WebSocket handshake: "+t,this.readyState=3,this.emit("error",Error(t)),this.emit("close",new h.CloseEvent(this.ERRORS.protocol_error,t))},_validateHandshake:function(){if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,this._http.error)return this._failHandshake(this._http.error.message);if(101!==this._http.statusCode)return this._failHandshake("Unexpected response code: "+this._http.statusCode);var t=this._http.headers,e=t.upgrade||"",s=t.connection||"",r=t["sec-websocket-accept"]||"",i=t["sec-websocket-protocol"]||"";if(""===e)return this._failHandshake("'Upgrade' header is missing");if("websocket"!==e.toLowerCase())return this._failHandshake("'Upgrade' header value is not 'WebSocket'");if(""===s)return this._failHandshake("'Connection' header is missing");if("upgrade"!==s.toLowerCase())return this._failHandshake("'Connection' header value is not 'Upgrade'");if(r!==this._accept)return this._failHandshake("Sec-WebSocket-Accept mismatch");if(this.protocol=null,""!==i){if(0>this._protocols.indexOf(i))return this._failHandshake("Sec-WebSocket-Protocol mismatch");this.protocol=i}try{this._extensions.activate(this.headers["sec-websocket-extensions"])}catch(t){return this._failHandshake(t.message)}}};for(var d in p)l.prototype[d]=p[d];t.exports=l},327:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(8891),n=s(8354),o=function(t,e,s){i.apply(this,arguments),this._stage=0,this.version="hixie-75",this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("WebSocket-Origin",this._request.headers.origin),this._headers.set("WebSocket-Location",this.url)};n.inherits(o,i);var a={close:function(){return 3!==this.readyState&&(this.readyState=3,this.emit("close",new i.CloseEvent(null,null)),!0)},parse:function(t){this.readyState>1||(this._reader.put(t),this._reader.eachByte(function(t){var e;switch(this._stage){case -1:this._body.push(t),this._sendHandshakeBody();break;case 0:this._parseLeadingByte(t);break;case 1:if(this._length=(127&t)+128*this._length,this._closing&&0===this._length)return this.close();(128&t)!=128&&(0===this._length?this._stage=0:(this._skipped=0,this._stage=2));break;case 2:if(255===t)this._stage=0,e=r.from(this._buffer).toString("utf8",0,this._buffer.length),this.emit("message",new i.MessageEvent(e));else if(this._length)this._skipped+=1,this._skipped===this._length&&(this._stage=0);else if(this._buffer.push(t),this._buffer.length>this._maxLength)return this.close()}},this))},frame:function(t){if(0===this.readyState)return this._queue([t]);if(this.readyState>1)return!1;"string"!=typeof t&&(t=t.toString());var e=r.byteLength(t),s=r.allocUnsafe(e+2);return s[0]=0,s.write(t,1),s[s.length-1]=255,this._write(s),!0},_handshakeResponse:function(){var t=["HTTP/1.1 101 Web Socket Protocol Handshake",this._headers.toString(),""];return r.from(t.join("\r\n"),"utf8")},_parseLeadingByte:function(t){(128&t)==128?(this._length=0,this._stage=1):(delete this._length,delete this._skipped,this._buffer=[],this._stage=2)}};for(var h in a)o.prototype[h]=a[h];t.exports=o},9418:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(8891),n=s(327),o=s(5511),a=s(8354),h=function(t){return parseInt((t.match(/[0-9]/g)||[]).join(""),10)},c=function(t){return(t.match(/ /g)||[]).length},u=function(t,e,s){n.apply(this,arguments),this._stage=-1,this._body=[],this.version="hixie-76",this._headers.clear(),this._headers.set("Upgrade","WebSocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Origin",this._request.headers.origin),this._headers.set("Sec-WebSocket-Location",this.url)};a.inherits(u,n);var l={BODY_SIZE:8,start:function(){return!!n.prototype.start.call(this)&&(this._started=!0,this._sendHandshakeBody(),!0)},close:function(){return 3!==this.readyState&&(1===this.readyState&&this._write(r.from([255,0])),this.readyState=3,this.emit("close",new i.CloseEvent(null,null)),!0)},_handshakeResponse:function(){var t=this._request.headers,e=t["sec-websocket-key1"],s=t["sec-websocket-key2"];if(!e)throw Error("Missing required header: Sec-WebSocket-Key1");if(!s)throw Error("Missing required header: Sec-WebSocket-Key2");var i=h(e),n=c(e),o=h(s),a=c(s);if(i%n!=0||o%a!=0)throw Error("Client sent invalid Sec-WebSocket-Key headers");this._keyValues=[i/n,o/a];var t=["HTTP/1.1 101 WebSocket Protocol Handshake",this._headers.toString(),""];return r.from(t.join("\r\n"),"binary")},_handshakeSignature:function(){if(this._body.length<this.BODY_SIZE)return null;var t=o.createHash("md5"),e=r.allocUnsafe(8+this.BODY_SIZE);return e.writeUInt32BE(this._keyValues[0],0),e.writeUInt32BE(this._keyValues[1],4),r.from(this._body).copy(e,8,0,this.BODY_SIZE),t.update(e),r.from(t.digest("binary"),"binary")},_sendHandshakeBody:function(){if(this._started){var t=this._handshakeSignature();t&&(this._write(t),this._stage=0,this._open(),this._body.length>this.BODY_SIZE&&this.parse(this._body.slice(this.BODY_SIZE)))}},_parseLeadingByte:function(t){if(255!==t)return n.prototype._parseLeadingByte.call(this,t);this._closing=!0,this._length=0,this._stage=1}};for(var p in l)u.prototype[p]=l[p];t.exports=u},6558:t=>{"use strict";var e=function(){this.clear()};e.prototype.ALLOWED_DUPLICATES=["set-cookie","set-cookie2","warning","www-authenticate"],e.prototype.clear=function(){this._sent={},this._lines=[]},e.prototype.set=function(t,e){if(void 0!==e){t=this._strip(t),e=this._strip(e);var s=t.toLowerCase();(!this._sent.hasOwnProperty(s)||this.ALLOWED_DUPLICATES.indexOf(s)>=0)&&(this._sent[s]=!0,this._lines.push(t+": "+e+"\r\n"))}},e.prototype.toString=function(){return this._lines.join("")},e.prototype._strip=function(t){return t.toString().replace(/^ */,"").replace(/ *$/,"")},t.exports=e},3528:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(5511),n=s(8354),o=s(1203),a=s(8891),h=s(6406),c=s(160),u=function(t,e,s){if(a.apply(this,arguments),this._extensions=new o,this._stage=0,this._masking=this._options.masking,this._protocols=this._options.protocols||[],this._requireMasking=this._options.requireMasking,this._pingCallbacks={},"string"==typeof this._protocols&&(this._protocols=this._protocols.split(/ *, */)),this._request){var r=this._request.headers["sec-websocket-protocol"],i=this._protocols;void 0!==r&&("string"==typeof r&&(r=r.split(/ *, */)),this.protocol=r.filter(function(t){return i.indexOf(t)>=0})[0]),this.version="hybi-"+u.VERSION}};n.inherits(u,a),u.VERSION="13",u.mask=function(t,e,s){if(!e||0===e.length)return t;s=s||0;for(var r=0,i=t.length-s;r<i;r++)t[s+r]=t[s+r]^e[r%4];return t},u.generateAccept=function(t){var e=i.createHash("sha1");return e.update(t+u.GUID),e.digest("base64")},u.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11";var l={FIN:128,MASK:128,RSV1:64,RSV2:32,RSV3:16,OPCODE:15,LENGTH:127,OPCODES:{continuation:0,text:1,binary:2,close:8,ping:9,pong:10},OPCODE_CODES:[0,1,2,8,9,10],MESSAGE_OPCODES:[0,1,2],OPENING_OPCODES:[1,2],ERRORS:{normal_closure:1e3,going_away:1001,protocol_error:1002,unacceptable:1003,encoding_error:1007,policy_violation:1008,too_large:1009,extension_error:1010,unexpected_condition:1011},ERROR_CODES:[1e3,1001,1002,1003,1007,1008,1009,1010,1011],DEFAULT_ERROR_CODE:1e3,MIN_RESERVED_ERROR:3e3,MAX_RESERVED_ERROR:4999,UTF8_MATCH:/^([\x00-\x7F]|[\xC2-\xDF][\x80-\xBF]|\xE0[\xA0-\xBF][\x80-\xBF]|[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}|\xED[\x80-\x9F][\x80-\xBF]|\xF0[\x90-\xBF][\x80-\xBF]{2}|[\xF1-\xF3][\x80-\xBF]{3}|\xF4[\x80-\x8F][\x80-\xBF]{2})*$/,addExtension:function(t){return this._extensions.add(t),!0},parse:function(t){this._reader.put(t);for(var e=!0;e;)switch(this._stage){case 0:(e=this._reader.read(1))&&this._parseOpcode(e[0]);break;case 1:(e=this._reader.read(1))&&this._parseLength(e[0]);break;case 2:(e=this._reader.read(this._frame.lengthBytes))&&this._parseExtendedLength(e);break;case 3:(e=this._reader.read(4))&&(this._stage=4,this._frame.maskingKey=e);break;case 4:(e=this._reader.read(this._frame.length))&&(this._stage=0,this._emitFrame(e));break;default:e=null}},text:function(t){return!(this.readyState>1)&&this.frame(t,"text")},binary:function(t){return!(this.readyState>1)&&this.frame(t,"binary")},ping:function(t,e){return!(this.readyState>1)&&(t=t||"",e&&(this._pingCallbacks[t]=e),this.frame(t,"ping"))},pong:function(t){return!(this.readyState>1)&&(t=t||"",this.frame(t,"pong"))},close:function(t,e){return(t=t||"",e=e||this.ERRORS.normal_closure,this.readyState<=0)?(this.readyState=3,this.emit("close",new a.CloseEvent(e,t)),!0):1===this.readyState&&(this.readyState=2,this._extensions.close(function(){this.frame(t,"close",e)},this),!0)},frame:function(t,e,s){if(this.readyState<=0)return this._queue([t,e,s]);if(this.readyState>2)return!1;t instanceof Array&&(t=r.from(t)),"number"==typeof t&&(t=t.toString());var n,o,a=new c,u="string"==typeof t;a.rsv1=a.rsv2=a.rsv3=!1,a.opcode=this.OPCODES[e||(u?"text":"binary")],n=u?r.from(t,"utf8"):t,s&&(o=n,(n=r.allocUnsafe(2+o.length)).writeUInt16BE(s,0),o.copy(n,2)),a.data=n;var l=function(t){var e=new h;e.final=!0,e.rsv1=t.rsv1,e.rsv2=t.rsv2,e.rsv3=t.rsv3,e.opcode=t.opcode,e.masked=!!this._masking,e.length=t.data.length,e.payload=t.data,e.masked&&(e.maskingKey=i.randomBytes(4)),this._sendFrame(e)};return this.MESSAGE_OPCODES.indexOf(a.opcode)>=0?this._extensions.processOutgoingMessage(a,function(t,e){if(t)return this._fail("extension_error",t.message);l.call(this,e)},this):l.call(this,a),!0},_sendFrame:function(t){var e=t.length,s=e<=125?2:e<=65535?4:10,i=s+(t.masked?4:0),n=r.allocUnsafe(i+e),o=t.masked?this.MASK:0;n[0]=(t.final?this.FIN:0)|(t.rsv1?this.RSV1:0)|(t.rsv2?this.RSV2:0)|(t.rsv3?this.RSV3:0)|t.opcode,e<=125?n[1]=o|e:e<=65535?(n[1]=126|o,n.writeUInt16BE(e,2)):(n[1]=127|o,n.writeUInt32BE(Math.floor(e/0x100000000),2),n.writeUInt32BE(e%0x100000000,6)),t.payload.copy(n,i),t.masked&&(t.maskingKey.copy(n,s),u.mask(n,t.maskingKey,i)),this._write(n)},_handshakeResponse:function(){var t=this._request.headers["sec-websocket-key"],e=this._request.headers["sec-websocket-version"];if(e!==u.VERSION)throw Error("Unsupported WebSocket version: "+e);if("string"!=typeof t)throw Error("Missing handshake request header: Sec-WebSocket-Key");this._headers.set("Upgrade","websocket"),this._headers.set("Connection","Upgrade"),this._headers.set("Sec-WebSocket-Accept",u.generateAccept(t)),this.protocol&&this._headers.set("Sec-WebSocket-Protocol",this.protocol);var s=this._extensions.generateResponse(this._request.headers["sec-websocket-extensions"]);s&&this._headers.set("Sec-WebSocket-Extensions",s);var i=["HTTP/1.1 101 Switching Protocols",this._headers.toString(),""];return r.from(i.join("\r\n"),"utf8")},_shutdown:function(t,e,s){delete this._frame,delete this._message,this._stage=5;var r=1===this.readyState;this.readyState=2,this._extensions.close(function(){r&&this.frame(e,"close",t),this.readyState=3,s&&this.emit("error",Error(e)),this.emit("close",new a.CloseEvent(t,e))},this)},_fail:function(t,e){this.readyState>1||this._shutdown(this.ERRORS[t],e,!0)},_parseOpcode:function(t){var e=[this.RSV1,this.RSV2,this.RSV3].map(function(e){return(t&e)===e}),s=this._frame=new h;return(s.final=(t&this.FIN)===this.FIN,s.rsv1=e[0],s.rsv2=e[1],s.rsv3=e[2],s.opcode=t&this.OPCODE,this._stage=1,this._extensions.validFrameRsv(s))?0>this.OPCODE_CODES.indexOf(s.opcode)?this._fail("protocol_error","Unrecognized frame opcode: "+s.opcode):0>this.MESSAGE_OPCODES.indexOf(s.opcode)&&!s.final?this._fail("protocol_error","Received fragmented control frame: opcode = "+s.opcode):this._message&&this.OPENING_OPCODES.indexOf(s.opcode)>=0?this._fail("protocol_error","Received new data frame but previous continuous frame is unfinished"):void 0:this._fail("protocol_error","One or more reserved bits are on: reserved1 = "+(s.rsv1?1:0)+", reserved2 = "+(s.rsv2?1:0)+", reserved3 = "+(s.rsv3?1:0))},_parseLength:function(t){var e=this._frame;if(e.masked=(t&this.MASK)===this.MASK,e.length=t&this.LENGTH,e.length>=0&&e.length<=125){if(this._stage=e.masked?3:4,!this._checkFrameLength())return}else this._stage=2,e.lengthBytes=126===e.length?2:8;if(this._requireMasking&&!e.masked)return this._fail("unacceptable","Received unmasked frame but masking is required")},_parseExtendedLength:function(t){var e=this._frame;if(e.length=this._readUInt(t),this._stage=e.masked?3:4,0>this.MESSAGE_OPCODES.indexOf(e.opcode)&&e.length>125)return this._fail("protocol_error","Received control frame having too long payload: "+e.length);if(!this._checkFrameLength())return},_checkFrameLength:function(){return!((this._message?this._message.length:0)+this._frame.length>this._maxLength)||(this._fail("too_large","WebSocket frame length too large"),!1)},_emitFrame:function(t){var e,s,r,i,n,o=this._frame,h=o.payload=u.mask(t,o.maskingKey),l=o.opcode;if(delete this._frame,l===this.OPCODES.continuation){if(!this._message)return this._fail("protocol_error","Received unexpected continuation frame");this._message.pushFrame(o)}if((l===this.OPCODES.text||l===this.OPCODES.binary)&&(this._message=new c,this._message.pushFrame(o)),o.final&&this.MESSAGE_OPCODES.indexOf(l)>=0)return this._emitMessage(this._message);l===this.OPCODES.close&&(s=h.length>=2?h.readUInt16BE(0):null,r=h.length>2?this._encode(h.slice(2)):null,0!==h.length&&!(null!==s&&s>=this.MIN_RESERVED_ERROR&&s<=this.MAX_RESERVED_ERROR)&&0>this.ERROR_CODES.indexOf(s)&&(s=this.ERRORS.protocol_error),(h.length>125||h.length>2&&!r)&&(s=this.ERRORS.protocol_error),this._shutdown(s||this.DEFAULT_ERROR_CODE,r||"")),l===this.OPCODES.ping&&(this.frame(h,"pong"),this.emit("ping",new a.PingEvent(h.toString()))),l===this.OPCODES.pong&&(n=(i=this._pingCallbacks)[e=this._encode(h)],delete i[e],n&&n(),this.emit("pong",new a.PongEvent(h.toString())))},_emitMessage:function(t){var t=this._message;t.read(),delete this._message,this._extensions.processIncomingMessage(t,function(t,e){if(t)return this._fail("extension_error",t.message);var s=e.data;if(e.opcode===this.OPCODES.text&&(s=this._encode(s)),null===s)return this._fail("encoding_error","Could not decode a text frame as UTF-8");this.emit("message",new a.MessageEvent(s))},this)},_encode:function(t){try{var e=t.toString("binary",0,t.length);if(!this.UTF8_MATCH.test(e))return null}catch(t){}return t.toString("utf8",0,t.length)},_readUInt:function(t){return 2===t.length?t.readUInt16BE(0):0x100000000*t.readUInt32BE(0)+t.readUInt32BE(4)}};for(var p in l)u.prototype[p]=l[p];t.exports=u},6406:t=>{"use strict";var e=function(){},s={final:!1,rsv1:!1,rsv2:!1,rsv3:!1,opcode:null,masked:!1,maskingKey:null,lengthBytes:1,length:0,payload:null};for(var r in s)e.prototype[r]=s[r];t.exports=e},160:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=function(){this.rsv1=!1,this.rsv2=!1,this.rsv3=!1,this.opcode=null,this.length=0,this._chunks=[]},n={read:function(){return this.data=this.data||r.concat(this._chunks,this.length)},pushFrame:function(t){this.rsv1=this.rsv1||t.rsv1,this.rsv2=this.rsv2||t.rsv2,this.rsv3=this.rsv3||t.rsv3,null===this.opcode&&(this.opcode=t.opcode),this._chunks.push(t.payload),this.length+=t.length}};for(var o in n)i.prototype[o]=n[o];t.exports=i},208:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=s(7910).Stream,n=s(9551),o=s(8354),a=s(8891),h=s(6558),c=s(9751),u={"ws:":80,"wss:":443},l=function(t,e,s){this._client=t,this._http=new c("response"),this._origin="object"==typeof t.url?t.url:n.parse(t.url),this._url="object"==typeof e?e:n.parse(e),this._options=s||{},this._state=0,this.readable=this.writable=!0,this._paused=!1,this._headers=new h,this._headers.set("Host",this._origin.host),this._headers.set("Connection","keep-alive"),this._headers.set("Proxy-Connection","keep-alive");var i=this._url.auth&&r.from(this._url.auth,"utf8").toString("base64");i&&this._headers.set("Proxy-Authorization","Basic "+i)};o.inherits(l,i);var p={setHeader:function(t,e){return 0===this._state&&(this._headers.set(t,e),!0)},start:function(){if(0!==this._state)return!1;this._state=1;var t=this._origin,e=t.port||u[t.protocol],s=["CONNECT "+t.hostname+":"+e+" HTTP/1.1",this._headers.toString(),""];return this.emit("data",r.from(s.join("\r\n"),"utf8")),!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1,this.emit("drain")},write:function(t){if(!this.writable)return!1;if(this._http.parse(t),!this._http.isComplete())return!this._paused;if(this.statusCode=this._http.statusCode,this.headers=this._http.headers,200===this.statusCode)this.emit("connect",new a.ConnectEvent);else{var e="Can't establish a connection to the server at "+this._origin.href;this.emit("error",Error(e))}return this.end(),!this._paused},end:function(t){this.writable&&(void 0!==t&&this.write(t),this.readable=this.writable=!1,this.emit("close"),this.emit("end"))},destroy:function(){this.end()}};for(var d in p)l.prototype[d]=p[d];t.exports=l},9821:(t,e,s)=>{"use strict";var r=s(8354),i=s(9751),n=s(8891),o=s(327),a=s(9418),h=s(3528),c=function(t){n.call(this,null,null,t),this._http=new i("request")};r.inherits(c,n);var u={EVENTS:["open","message","error","close","ping","pong"],_bindEventListeners:function(){this.messages.on("error",function(){}),this.on("error",function(){})},parse:function(t){if(this._delegate)return this._delegate.parse(t);if(this._http.parse(t),this._http.isComplete()){this.method=this._http.method,this.url=this._http.url,this.headers=this._http.headers,this.body=this._http.body;var e=this;this._delegate=c.http(this,this._options),this._delegate.messages=this.messages,this._delegate.io=this.io,this._open(),this.EVENTS.forEach(function(t){this._delegate.on(t,function(s){e.emit(t,s)})},this),this.protocol=this._delegate.protocol,this.version=this._delegate.version,this.parse(this._http.body),this.emit("connect",new n.ConnectEvent)}},_open:function(){this.__queue.forEach(function(t){this._delegate[t[0]].apply(this._delegate,t[1])},this),this.__queue=[]}};for(var l in["addExtension","setHeader","start","frame","text","binary","ping","close"].forEach(function(t){u[t]=function(){return this._delegate?this._delegate[t].apply(this._delegate,arguments):(this.__queue.push([t,arguments]),!0)}}),u)c.prototype[l]=u[l];c.isSecureRequest=function(t){if(t.connection&&void 0!==t.connection.authorized||t.socket&&t.socket.secure)return!0;var e=t.headers;return!!e&&("on"===e.https||"on"===e["x-forwarded-ssl"]||"https"===e["x-forwarded-scheme"]||"https"===e["x-forwarded-proto"])},c.determineUrl=function(t){return(this.isSecureRequest(t)?"wss:":"ws:")+"//"+t.headers.host+t.url},c.http=function(t,e){void 0===(e=e||{}).requireMasking&&(e.requireMasking=!0);var s=t.headers,r=s["sec-websocket-version"],i=s["sec-websocket-key"],n=s["sec-websocket-key1"],c=s["sec-websocket-key2"],u=this.determineUrl(t);return r||i?new h(t,u,e):n||c?new a(t,u,e):new o(t,u,e)},t.exports=c},118:(t,e,s)=>{"use strict";var r=s(6233).Buffer,i=function(){this._queue=[],this._queueSize=0,this._offset=0};i.prototype.put=function(t){t&&0!==t.length&&(r.isBuffer(t)||(t=r.from(t)),this._queue.push(t),this._queueSize+=t.length)},i.prototype.read=function(t){if(t>this._queueSize)return null;if(0===t)return r.alloc(0);this._queueSize-=t;var e,s,i=this._queue,n=t,o=i[0];if(o.length>=t)return o.length===t?i.shift():(s=o.slice(0,t),i[0]=o.slice(t),s);for(var a=0,h=i.length;a<h&&!(n<i[a].length);a++)n-=i[a].length;return e=i.splice(0,a),n>0&&i.length>0&&(e.push(i[0].slice(0,n)),i[0]=i[0].slice(n)),r.concat(e,t)},i.prototype.eachByte=function(t,e){for(var s,r,i;this._queue.length>0;){for(r=(s=this._queue[0]).length;this._offset<r;)i=this._offset,this._offset+=1,t.call(e,s[i]);this._offset=0,this._queue.shift()}},t.exports=i},9751:(t,e,s)=>{"use strict";var r=s(1077).e,i=s(6233).Buffer,n={request:r.REQUEST||"request",response:r.RESPONSE||"response"},o=function(t){this._type=t,this._parser=new r(n[t]),this._complete=!1,this.headers={};var e=null,s=this;this._parser.onHeaderField=function(t,s,r){e=t.toString("utf8",s,s+r).toLowerCase()},this._parser.onHeaderValue=function(t,r,i){var n=t.toString("utf8",r,r+i);s.headers.hasOwnProperty(e)?s.headers[e]+=", "+n:s.headers[e]=n},this._parser.onHeadersComplete=this._parser[r.kOnHeadersComplete]=function(t,e,r,i,n,a){var h=arguments[0];if("object"==typeof h&&(i=h.method,n=h.url,a=h.statusCode,r=h.headers),s.method="number"==typeof i?o.METHODS[i]:i,s.statusCode=a,s.url=n,r){for(var c,u,l=0,p=r.length;l<p;l+=2)c=r[l].toLowerCase(),u=r[l+1],s.headers.hasOwnProperty(c)?s.headers[c]+=", "+u:s.headers[c]=u;s._complete=!0}}};o.METHODS={0:"DELETE",1:"GET",2:"HEAD",3:"POST",4:"PUT",5:"CONNECT",6:"OPTIONS",7:"TRACE",8:"COPY",9:"LOCK",10:"MKCOL",11:"MOVE",12:"PROPFIND",13:"PROPPATCH",14:"SEARCH",15:"UNLOCK",16:"BIND",17:"REBIND",18:"UNBIND",19:"ACL",20:"REPORT",21:"MKACTIVITY",22:"CHECKOUT",23:"MERGE",24:"M-SEARCH",25:"NOTIFY",26:"SUBSCRIBE",27:"UNSUBSCRIBE",28:"PATCH",29:"PURGE",30:"MKCALENDAR",31:"LINK",32:"UNLINK"};var a=process.version?process.version.match(/[0-9]+/g).map(function(t){return parseInt(t,10)}):[];0===a[0]&&12===a[1]&&(o.METHODS[16]="REPORT",o.METHODS[17]="MKACTIVITY",o.METHODS[18]="CHECKOUT",o.METHODS[19]="MERGE",o.METHODS[20]="M-SEARCH",o.METHODS[21]="NOTIFY",o.METHODS[22]="SUBSCRIBE",o.METHODS[23]="UNSUBSCRIBE",o.METHODS[24]="PATCH",o.METHODS[25]="PURGE"),o.prototype.isComplete=function(){return this._complete},o.prototype.parse=function(t){var e=this._parser.execute(t,0,t.length);if("number"!=typeof e){this.error=e,this._complete=!0;return}this._complete&&(this.body=e<t.length?t.slice(e):i.alloc(0))},t.exports=o},9836:(t,e,s)=>{"use strict";var r=s(7910).Stream,i=s(8354),n=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};i.inherits(n,r),n.prototype.pause=function(){this._paused=!0,this._driver.messages._paused=!0},n.prototype.resume=function(){this._paused=!1,this.emit("drain");var t=this._driver.messages;t._paused=!1,t.emit("drain")},n.prototype.write=function(t){return!!this.writable&&(this._driver.parse(t),!this._paused)},n.prototype.end=function(t){if(this.writable){void 0!==t&&this.write(t),this.writable=!1;var e=this._driver.messages;e.readable&&(e.readable=e.writable=!1,e.emit("end"))}},n.prototype.destroy=function(){this.end()};var o=function(t){this.readable=this.writable=!0,this._paused=!1,this._driver=t};i.inherits(o,r),o.prototype.pause=function(){this._driver.io._paused=!0},o.prototype.resume=function(){this._driver.io._paused=!1,this._driver.io.emit("drain")},o.prototype.write=function(t){return!!this.writable&&("string"==typeof t?this._driver.text(t):this._driver.binary(t),!this._paused)},o.prototype.end=function(t){void 0!==t&&this.write(t)},o.prototype.destroy=function(){},e.IO=n,e.Messages=o},9894:t=>{"use strict";var e=/([!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+)/,s=/([^!#\$%&'\*\+\-\.\^_`\|~0-9A-Za-z])/g,r=RegExp(e.source+"(?:=(?:"+e.source+"|"+/"((?:\\[\x00-\x7f]|[^\x00-\x08\x0a-\x1f\x7f"\\])*)"/.source+"))?"),i=RegExp(e.source+"(?: *; *"+r.source+")*","g"),n=RegExp("^"+i.source+"(?: *, *"+i.source+")*$"),o=/^-?(0|[1-9][0-9]*)(\.[0-9]+)?$/,a=Object.prototype.hasOwnProperty,h=function(){this._byName={},this._inOrder=[]};h.prototype.push=function(t,e){a.call(this._byName,t)||(this._byName[t]=[]),this._byName[t].push(e),this._inOrder.push({name:t,params:e})},h.prototype.eachOffer=function(t,e){for(var s=this._inOrder,r=0,i=s.length;r<i;r++)t.call(e,s[r].name,s[r].params)},h.prototype.byName=function(t){return this._byName[t]||[]},h.prototype.toArray=function(){return this._inOrder.slice()},t.exports={parseHeader:function(t){var e=new h;if(""===t||void 0===t)return e;if(!n.test(t))throw SyntaxError("Invalid Sec-WebSocket-Extensions header: "+t);return t.match(i).forEach(function(t){var s=t.match(RegExp(r.source,"g")),i=s.shift(),n={};s.forEach(function(t){var e,s=t.match(r),i=s[1];e=void 0!==s[2]?s[2]:void 0===s[3]||s[3].replace(/\\/g,""),o.test(e)&&(e=parseFloat(e)),a.call(n,i)?(n[i]=[].concat(n[i]),n[i].push(e)):n[i]=e},this),e.push(i,n)},this),e},serializeParams:function(t,e){var r=[],i=function(t,e){e instanceof Array?e.forEach(function(e){i(t,e)}):!0===e?r.push(t):"number"==typeof e?r.push(t+"="+e):s.test(e)?r.push(t+'="'+e.replace(/"/g,'\\"')+'"'):r.push(t+"="+e)};for(var n in e)i(n,e[n]);return[t].concat(r).join("; ")}}},485:(t,e,s)=>{"use strict";var r=s(6443),i=s(675),n=function(t){this._ext=t[0],this._session=t[1],this._functors={incoming:new r(this._session,"processIncomingMessage"),outgoing:new r(this._session,"processOutgoingMessage")}};n.prototype.pending=function(t){var e=this._functors[t];e._stopped||(e.pending+=1)},n.prototype.incoming=function(t,e,s,r){this._exec("incoming",t,e,s,r)},n.prototype.outgoing=function(t,e,s,r){this._exec("outgoing",t,e,s,r)},n.prototype.close=function(){return this._closed=this._closed||new i,this._doClose(),this._closed},n.prototype._exec=function(t,e,s,r,i){this._functors[t].call(e,s,function(t,e){t&&(t.message=this._ext.name+": "+t.message),r.call(i,t,e),this._doClose()},this)},n.prototype._doClose=function(){var t=this._functors.incoming,e=this._functors.outgoing;this._closed&&t.pending+e.pending===0&&(this._session&&this._session.close(),this._session=null,this._closed.done())},t.exports=n},6443:(t,e,s)=>{"use strict";var r=s(6873),i=function(t,e){this._session=t,this._method=e,this._queue=new r(i.QUEUE_SIZE),this._stopped=!1,this.pending=0};i.QUEUE_SIZE=8,i.prototype.call=function(t,e,s,r){if(!this._stopped){var i={error:t,message:e,callback:s,context:r,done:!1},n=!1,o=this;if(this._queue.push(i),i.error)return i.done=!0,this._stop(),this._flushQueue();var a=function(t,e){n^(n=!0)&&(t?(o._stop(),i.error=t,i.message=null):i.message=e,i.done=!0,o._flushQueue())};try{this._session[this._method](e,a)}catch(t){a(t)}}},i.prototype._stop=function(){this.pending=this._queue.length,this._stopped=!0},i.prototype._flushQueue=function(){for(var t,e=this._queue;e.length>0&&e.peek().done;)(t=e.shift()).error?(this.pending=0,e.clear()):this.pending-=1,t.callback.call(t.context,t.error,t.message)},t.exports=i},6832:(t,e,s)=>{"use strict";var r=s(485),i=s(675),n=function(t){this._cells=t.map(function(t){return new r(t)}),this._stopped={incoming:!1,outgoing:!1}};n.prototype.processIncomingMessage=function(t,e,s){this._stopped.incoming||this._loop("incoming",this._cells.length-1,-1,-1,t,e,s)},n.prototype.processOutgoingMessage=function(t,e,s){this._stopped.outgoing||this._loop("outgoing",0,this._cells.length,1,t,e,s)},n.prototype.close=function(t,e){this._stopped={incoming:!0,outgoing:!0};var s=this._cells.map(function(t){return t.close()});t&&i.all(s).then(function(){t.call(e)})},n.prototype._loop=function(t,e,s,r,i,n,o){for(var a=this._cells,h=a.length,c=this;h--;)a[h].pending(t);var u=function(e,i,h){if(e===s)return n.call(o,i,h);a[e][t](i,h,function(s,i){s&&(c._stopped[t]=!0),u(e+r,s,i)})};u(e,null,i)},t.exports=n},675:(t,e,s)=>{"use strict";var r=s(6873),i=function(){this._complete=!1,this._callbacks=new r(i.QUEUE_SIZE)};i.QUEUE_SIZE=4,i.all=function(t){var e=new i,s=t.length,r=s;for(0===s&&e.done();r--;)t[r].then(function(){0==(s-=1)&&e.done()});return e},i.prototype.then=function(t){this._complete?t():this._callbacks.push(t)},i.prototype.done=function(){this._complete=!0;for(var t,e=this._callbacks;t=e.shift();)t()},t.exports=i},6873:t=>{"use strict";var e=function(t){this._bufferSize=t,this.clear()};e.prototype.clear=function(){this._buffer=Array(this._bufferSize),this._ringOffset=0,this._ringSize=this._bufferSize,this._head=0,this._tail=0,this.length=0},e.prototype.push=function(t){var e=!1,s=!1;this._ringSize<this._bufferSize?e=0===this._tail:this._ringOffset===this._ringSize&&(e=!0,s=0===this._tail),e&&(this._tail=this._bufferSize,this._buffer=this._buffer.concat(Array(this._bufferSize)),this._bufferSize=this._buffer.length,s&&(this._ringSize=this._bufferSize)),this._buffer[this._tail]=t,this.length+=1,this._tail<this._ringSize&&(this._ringOffset+=1),this._tail=(this._tail+1)%this._bufferSize},e.prototype.peek=function(){if(0!==this.length)return this._buffer[this._head]},e.prototype.shift=function(){if(0!==this.length){var t=this._buffer[this._head];return this._buffer[this._head]=void 0,this.length-=1,this._ringOffset-=1,0===this._ringOffset&&this.length>0?(this._head=this._ringSize,this._ringOffset=this.length,this._ringSize=this._bufferSize):this._head=(this._head+1)%this._ringSize,t}},t.exports=e},1203:(t,e,s)=>{"use strict";var r=s(9894),i=s(6832),n=function(){this._rsv1=this._rsv2=this._rsv3=null,this._byName={},this._inOrder=[],this._sessions=[],this._index={}};n.MESSAGE_OPCODES=[1,2];var o={add:function(t){if("string"!=typeof t.name)throw TypeError("extension.name must be a string");if("permessage"!==t.type)throw TypeError('extension.type must be "permessage"');if("boolean"!=typeof t.rsv1)throw TypeError("extension.rsv1 must be true or false");if("boolean"!=typeof t.rsv2)throw TypeError("extension.rsv2 must be true or false");if("boolean"!=typeof t.rsv3)throw TypeError("extension.rsv3 must be true or false");if(this._byName.hasOwnProperty(t.name))throw TypeError('An extension with name "'+t.name+'" is already registered');this._byName[t.name]=t,this._inOrder.push(t)},generateOffer:function(){var t=[],e=[],s={};return this._inOrder.forEach(function(i){var n=i.createClientSession();if(n){var o=[i,n];t.push(o),s[i.name]=o;var a=n.generateOffer();(a=a?[].concat(a):[]).forEach(function(t){e.push(r.serializeParams(i.name,t))},this)}},this),this._sessions=t,this._index=s,e.length>0?e.join(", "):null},activate:function(t){var e=r.parseHeader(t),s=[];e.eachOffer(function(t,e){var i=this._index[t];if(!i)throw Error('Server sent an extension response for unknown extension "'+t+'"');var n=i[0],o=i[1],a=this._reserved(n);if(a)throw Error("Server sent two extension responses that use the RSV"+a[0]+' bit: "'+a[1]+'" and "'+n.name+'"');if(!0!==o.activate(e))throw Error("Server sent unacceptable extension parameters: "+r.serializeParams(t,e));this._reserve(n),s.push(i)},this),this._sessions=s,this._pipeline=new i(s)},generateResponse:function(t){var e=[],s=[],n=r.parseHeader(t);return this._inOrder.forEach(function(t){var i=n.byName(t.name);if(!(0===i.length||this._reserved(t))){var o=t.createServerSession(i);o&&(this._reserve(t),e.push([t,o]),s.push(r.serializeParams(t.name,o.generateResponse())))}},this),this._sessions=e,this._pipeline=new i(e),s.length>0?s.join(", "):null},validFrameRsv:function(t){var e,s={rsv1:!1,rsv2:!1,rsv3:!1};if(n.MESSAGE_OPCODES.indexOf(t.opcode)>=0)for(var r=0,i=this._sessions.length;r<i;r++)e=this._sessions[r][0],s.rsv1=s.rsv1||e.rsv1,s.rsv2=s.rsv2||e.rsv2,s.rsv3=s.rsv3||e.rsv3;return(s.rsv1||!t.rsv1)&&(s.rsv2||!t.rsv2)&&(s.rsv3||!t.rsv3)},processIncomingMessage:function(t,e,s){this._pipeline.processIncomingMessage(t,e,s)},processOutgoingMessage:function(t,e,s){this._pipeline.processOutgoingMessage(t,e,s)},close:function(t,e){if(!this._pipeline)return t.call(e);this._pipeline.close(t,e)},_reserve:function(t){this._rsv1=this._rsv1||t.rsv1&&t.name,this._rsv2=this._rsv2||t.rsv2&&t.name,this._rsv3=this._rsv3||t.rsv3&&t.name},_reserved:function(t){return this._rsv1&&t.rsv1?[1,this._rsv1]:this._rsv2&&t.rsv2?[2,this._rsv2]:!!this._rsv3&&!!t.rsv3&&[3,this._rsv3]}};for(var a in o)n.prototype[a]=o[a];t.exports=n},1079:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>y});var r,i,n=s(5512),o=s(8009);let a={LF:"\n",NULL:"\0"};class h{constructor(t){let{command:e,headers:s,body:r,binaryBody:i,escapeHeaderValues:n,skipContentLengthHeader:o}=t;this.command=e,this.headers=Object.assign({},s||{}),i?(this._binaryBody=i,this.isBinaryBody=!0):(this._body=r||"",this.isBinaryBody=!1),this.escapeHeaderValues=n||!1,this.skipContentLengthHeader=o||!1}get body(){return!this._body&&this.isBinaryBody&&(this._body=new TextDecoder().decode(this._binaryBody)),this._body||""}get binaryBody(){return this._binaryBody||this.isBinaryBody||(this._binaryBody=new TextEncoder().encode(this._body)),this._binaryBody}static fromRawFrame(t,e){let s={},r=t=>t.replace(/^\s+|\s+$/g,"");for(let i of t.headers.reverse()){i.indexOf(":");let n=r(i[0]),o=r(i[1]);e&&"CONNECT"!==t.command&&"CONNECTED"!==t.command&&(o=h.hdrValueUnEscape(o)),s[n]=o}return new h({command:t.command,headers:s,binaryBody:t.binaryBody,escapeHeaderValues:e})}toString(){return this.serializeCmdAndHeaders()}serialize(){let t=this.serializeCmdAndHeaders();return this.isBinaryBody?h.toUnit8Array(t,this._binaryBody).buffer:t+this._body+a.NULL}serializeCmdAndHeaders(){let t=[this.command];for(let e of(this.skipContentLengthHeader&&delete this.headers["content-length"],Object.keys(this.headers||{}))){let s=this.headers[e];this.escapeHeaderValues&&"CONNECT"!==this.command&&"CONNECTED"!==this.command?t.push(`${e}:${h.hdrValueEscape(`${s}`)}`):t.push(`${e}:${s}`)}return!this.isBinaryBody&&(this.isBodyEmpty()||this.skipContentLengthHeader)||t.push(`content-length:${this.bodyLength()}`),t.join(a.LF)+a.LF+a.LF}isBodyEmpty(){return 0===this.bodyLength()}bodyLength(){let t=this.binaryBody;return t?t.length:0}static sizeOfUTF8(t){return t?new TextEncoder().encode(t).length:0}static toUnit8Array(t,e){let s=new TextEncoder().encode(t),r=new Uint8Array([0]),i=new Uint8Array(s.length+e.length+r.length);return i.set(s),i.set(e,s.length),i.set(r,s.length+e.length),i}static marshall(t){return new h(t).serialize()}static hdrValueEscape(t){return t.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/:/g,"\\c")}static hdrValueUnEscape(t){return t.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\c/g,":").replace(/\\\\/g,"\\")}}(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.OPEN=1]="OPEN",t[t.CLOSING=2]="CLOSING",t[t.CLOSED=3]="CLOSED"})(r=r||(r={})),function(t){t[t.ACTIVE=0]="ACTIVE",t[t.DEACTIVATING=1]="DEACTIVATING",t[t.INACTIVE=2]="INACTIVE"}(i=i||(i={}));class c{constructor(t){this.versions=t}supportedVersions(){return this.versions.join(",")}protocolVersions(){return this.versions.map(t=>`v${t.replace(".","")}.stomp`)}}c.V1_0="1.0",c.V1_1="1.1",c.V1_2="1.2",c.default=new c([c.V1_2,c.V1_1,c.V1_0]);var u=s(9334),l=s(9309),p=s(1356);s(4306);var d=s(5624);let f=({selectChat:t,chatRooms:e})=>(0,n.jsxs)("aside",{className:"w-1/4 bg-gray-900 p-4 h-screen shadow-lg flex flex-col overflow-hidden",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Chats"}),(0,n.jsx)("ul",{className:"space-y-2 overflow-y-auto flex-1",children:[...e.values()].map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("button",{className:"w-full bg-gray-800 hover:bg-gray-700 text-white px-4 py-2 rounded transition text-left",onClick:()=>t(e.chatId,e.recipient),children:e.recipient})},e.id))})]}),m=({handleSendMessage:t,setInputMessage:e,inputMessage:s,currentCompanion:r})=>(0,n.jsxs)("div",{className:"mt-4 flex p-2 bg-gray-800 rounded-b-lg",children:[(0,n.jsx)("input",{type:"text",className:"flex-grow p-2 rounded bg-gray-700 border border-gray-600 text-white",placeholder:`Enter message for ${r}`,onChange:t=>e(t.target.value),value:s,onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),t())}),(0,n.jsx)("button",{className:"ml-2 bg-blue-600 hover:bg-blue-500 px-4 py-2 text-white rounded transition",onClick:t,children:"Send"})]}),_=({messages:t,currentCompanion:e,handleSendMessage:s,inputMessage:r,setInputMessage:i,userEmail:o})=>(0,n.jsxs)("main",{className:"flex-1 p-6 flex flex-col h-screen overflow-hidden",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-white",children:e}),(0,n.jsxs)("div",{className:"w-full bg-gray-900 p-4 rounded-lg shadow-lg mt-4 flex flex-col flex-1 overflow-hidden",children:[(0,n.jsx)("div",{className:"flex-1 overflow-y-auto p-2 space-y-2",children:t.length>0?t.map(t=>(0,n.jsxs)("div",{className:`p-3 rounded max-w-[75%] ${t.sender===o?"bg-blue-600 text-white ml-auto":"bg-gray-800 text-gray-300"}`,children:[t.content,(0,n.jsx)("div",{className:"text-xs text-gray-400 flex justify-end self-end mt-1",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},t.id)):(0,n.jsx)("div",{className:"text-gray-400 flex items-center justify-center h-full",children:"You are messaging for the first time"})}),(0,n.jsx)(m,{currentCompanion:e,handleSendMessage:s,inputMessage:r,setInputMessage:i})]})]});var g=function(t){return t[t.RECEIVED=0]="RECEIVED",t[t.DELIVERED=1]="DELIVERED",t}({});function v(){let{user:t}=(0,l.A)(),{chatRooms:e,chatRoomMessages:s,currentChatId:r,currentCompanion:i,selectChat:a,sendMessage:h}=function(){let{user:t}=(0,l.A)(),e=((0,u.useSearchParams)(),(0,o.useRef)(null)),[s,r]=(0,o.useState)(new Map),[i,n]=(0,o.useState)(new Map),[a,h]=(0,o.useState)(""),[c,f]=(0,o.useState)(""),m=crypto.randomUUID(),_=async(e,s)=>{if(!t)return;let r=await p.F.chat.fetchChatRoomMessages(t.email,s);for(let e of(console.log("messages from datasource:",JSON.stringify(r)),r))e.sender===t.email?e.content=await y(e):e.content=await v(e);n(t=>new Map(t).set(e,r))},g=async(i,o="/app/chat")=>{if(!t)return;let h=i.content;{let t=await (0,d.cd)(),{encryptedData:e,iv:s}=await (0,d.zp)(h,t);i.content=e,i.iv=s;let r=(await p.F.user.getUserByEmail(i.recipient)).data;i.encryptedAesKey=await (0,d.Il)(t,r.publicKey)}{let e=await (0,d.cd)(),{encryptedData:s,iv:r}=await (0,d.zp)(h,e);i.contentForSelf=s,i.ivForSelf=r,i.encryptedAesKeyForSelf=await (0,d.Il)(e,t.publicKey)}console.log("sending message",i),e.current?.publish({destination:o,body:JSON.stringify(i)}),n(t=>{let e=new Map(t),s=e.get(a)||[];return i.id=m,i.content=h,e.set(a,[...s,i]),e}),s.has(a)||r(t=>{let e=new Map(t);return e.set(a,{id:m,chatId:a,sender:i.sender,recipient:c}),e})},v=async t=>b(t.content,t.encryptedAesKey,t.iv),y=async t=>b(t.contentForSelf,t.encryptedAesKeyForSelf,t.ivForSelf),b=async(t,e,s)=>{let r=await (0,d.Tn)();if(!r)return console.error("User does not have private key"),Promise.reject("User does not have private key");let i=await (0,d.cu)(e,r);return await (0,d.jR)(t,s,i)};return{chatRooms:s,chatRoomMessages:i,currentChatId:a,currentCompanion:c,selectChat:async(t,e)=>{h(t),f(e),await _(t,e)},sendMessage:g}}(),[c,m]=(0,o.useState)("");return t?(0,n.jsxs)("div",{className:"h-screen bg-black text-gray-300 flex overflow-hidden",children:[(0,n.jsx)(f,{selectChat:a,chatRooms:e}),i?(0,n.jsx)(_,{messages:s.get(r)||[],currentCompanion:i,handleSendMessage:()=>{c.trim()&&(console.log(`Sending: ${c}`),h({chatId:r,type:"MESSAGE",content:c,recipient:i,sender:t.email,status:g.DELIVERED,timestamp:new Date}),m(""))},inputMessage:c,setInputMessage:m,userEmail:t.email}):(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-400",children:"Select a chat to start messaging"})]}):(0,n.jsx)("div",{children:"Loading..."})}function y(){return(0,n.jsx)(v,{})}},5274:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>r});let r=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/relucky/Desktop/programming/react/aitu-net-frontend/src/app/chat/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/relucky/Desktop/programming/react/aitu-net-frontend/src/app/chat/page.tsx","default")},440:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>i});var r=s(8077);let i=async t=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await t.params,"favicon.ico")+""}]}};var e=require("../../webpack-runtime.js");e.C(t);var s=t=>e(e.s=t),r=e.X(0,[638,849,77,928],()=>s(7485));module.exports=r})();