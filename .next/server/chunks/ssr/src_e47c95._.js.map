{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/relucky/Desktop/programming/react/aitu-net-frontend/src/components/users/Profile.tsx"],"sourcesContent":["'use client';\n\nimport {useAuth} from '@/context/AuthProvider';\nimport React, {useEffect, useRef, useState} from 'react';\nimport Link from \"next/link\";\nimport {api} from \"@/lib\";\n\nexport default function Profile() {\n    const {user, loadUser} = useAuth();\n    const [loading, setLoading] = useState(true);\n    const [selectedFile, setSelectedFile] = useState<File | null>(null);\n    const [menuOpen, setMenuOpen] = useState(false);\n    const menuRef = useRef<HTMLDivElement | null>(null);\n\n    useEffect(() => {\n        loadUser()\n    }, []);\n\n    useEffect(() => {\n        if (user) {\n            setLoading(false);\n        }\n    }, [user]);\n\n    useEffect(() => {\n        handleUpload();\n        setMenuOpen(false);\n    }, [selectedFile]);\n\n    useEffect(() => {\n        const handleClickOutside = (event: MouseEvent) => {\n            if (menuRef.current && !(menuRef.current as HTMLElement).contains(event.target as Node)) {\n                setMenuOpen(false);\n            }\n        };\n\n        if (menuOpen) {\n            document.addEventListener(\"mousedown\", handleClickOutside);\n        }\n\n        return () => {\n            document.removeEventListener(\"mousedown\", handleClickOutside);\n        };\n    }, [menuOpen]);\n\n    const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        if (event.target.files?.length) {\n            setSelectedFile(event.target.files[0]);\n        }\n    };\n\n    const handleUpload = async () => {\n        if (!selectedFile || !user) return;\n        try {\n            await api.user.uploadProfilePhoto(selectedFile);\n            alert(\"Successfully uploaded photo\");\n            loadUser();\n        } catch (error) {\n            console.error(\"Error with upload\", error);\n            alert(\"Error with upload\");\n        }\n    };\n\n    if (loading) return <p>Загрузка...</p>;\n    if (!user) return null;\n\n    const toggleMenu = () => {\n        setMenuOpen(!menuOpen);\n    }\n    const handleDelete = () => {\n        api.user.deleteProfilePhoto();\n        console.log(\"Photo deleted\");\n        setMenuOpen(false);\n        window.location.reload();\n    };\n\n    return (\n        <div className=\"flex pl-10 justify-betweenш items-center\">\n            {/* Image Block */}\n            <div className=\"flex flex-col items-center mr-20 relative\">\n                {/* Фото профиля */}\n                <img\n                    src={user?.avatar?.location || \"/def_pfp.svg\"}\n                    alt=\"Profile\"\n                    className=\"w-32 h-38 rounded-full cursor-pointer\"\n                    onClick={toggleMenu}\n                />\n\n                {/* Выпадающее меню */}\n                {menuOpen && (\n                    <div\n                        ref={menuRef}\n                        className=\"absolute top-[calc(100%+8px)] left-1/2 -translate-x-1/2 w-40 bg-white shadow-md rounded-lg border border-gray-200\"\n                    >\n                        {/* Кнопка загрузки */}\n                        <label\n                            htmlFor=\"fileInput\"\n                            className=\"block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer\"\n                        >\n                            Обновить фото\n                        </label>\n                        <input\n                            id=\"fileInput\"\n                            type=\"file\"\n                            accept=\"image/*\"\n                            className=\"hidden\"\n                            onChange={(e) => {\n                                handleFileChange(e)\n                                setMenuOpen(false)\n                            }}\n                        />\n\n                        {/* Кнопка удаления */}\n                        <button\n                            onClick={() => {\n                                console.log(\"Фото удалено\");\n                                handleDelete();\n                                setMenuOpen(false);\n                            }}\n                            className=\"block w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100\"\n                        >\n                            Удалить фото\n                        </button>\n                    </div>\n                )}\n            </div>\n\n\n            <div className=\"max-w-md p-6 bg-gray-900 text-white rounded-lg shadow-lg\">\n                <h1 className=\"text-2xl font-semibold mb-4 text-blue-400\">Profile</h1>\n\n                <div className=\"space-y-2\">\n                    <p>\n                        <span className=\"font-semibold text-gray-400\">Username:</span> {user?.username}\n                    </p>\n                    <p>\n                        <span className=\"font-semibold text-gray-400\">Email:</span> {user?.email}\n                    </p>\n                    <p>\n                        <span\n                            className=\"font-semibold text-gray-400\">Friend List:</span> {user?.friendList?.join(\", \") || \"No friends\"}\n                    </p>\n                    <p>\n                        <span className=\"font-semibold text-gray-400\">Roles:</span> {user?.roles?.join(\", \")}\n                    </p>\n                    {user?.description && (\n                        <p>\n                            <span className=\"font-semibold text-gray-400\">Bio:</span> {user.description}\n                        </p>\n                    )}\n                    <Link\n                        href=\"/users/edit\"\n                        className=\"mt-4 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-semibold rounded-lg shadow-md transition duration-300 block\"\n                    >\n                        Edit Profile\n                    </Link>\n\n                </div>\n            </div>\n        </div>\n    )\n\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}